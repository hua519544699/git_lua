--图片路径
PIC_PATH = "/var/touchelf/scripts/lianji_images/"
--挂机
color_guaji = { 0x082431, -32, -9, 0xA5EBF7, -27, -9, 0xA5E7EF, -22, -9, 0x8CCBCE, -24, -2, 0x94D3DE, -27, -2, 0x8CC7CE, -31, -2, 0x9CDBDE, -25, 5, 0xA5EBF7, -28, 5, 0xA5DBE7, -34, 8, 0xADEBF7, -23, 13, 0x9CDFE7, -34, 15, 0xADE7EF, -32, 9, 0xADE3E7 }
--角色进入游戏
color_juesejinru = { 0x42D7FF, 1, -12, 0x31BAFF, 4, 19, 0x4AE7FF, 2, 41, 0x4AFBFF, 4, 53, 0x52FBFF, 28, 25, 0xBDFFFF, 32, 0, 0xC6FFFF, 29, -9, 0xB5FFFF, 26, -21, 0xADFFFF, 26, -4, 0xCEFFFF, 30, 54, 0xC6FFFF }
--点击任务
color_renwu = { 0x5AAECE, 16, 13, 0xBDE7EF, -1, 11, 0x4AA6C6, 12, 0, 0xB5E7EF, 16, 4, 0xCEF7F7, 19, 12, 0xC6EFF7, 2, -3, 0x63B6C6, 1, 0, 0x63AECE, 3, 3, 0x6BBED6, 8, 8, 0x9CDBE7 }
--任务眼
color_renwuyan = { 0x84E3F7, 0, -15, 0x84DBEF, -8, -3, 0x84DFEF, 0, 13, 0x7BD7EF, 8, 1, 0x8CE3F7, 5, -9, 0x84E7F7, -4, 8, 0x84E3F7 }
--跳过
color_tiaoguo = { 0x7BB6D6, 6, -7, 0x7BBAD6, -6, -6, 0x73AECE, -6, 22, 0x73B2D6, 1, 30, 0x73AACE, 9, 37, 0x7BBADE, -5, 22, 0x7BBADE }
--使用方向键移动
color_fangxiang = { 0xEFC76B, 1, -12, 0xF7D773, 5, -22, 0xFFDB73, 0, 8, 0xFFD76B, 4, 26, 0xF7D36B, 9, 30, 0xE7CB6B, 3, 36, 0xF7D773, -5, 35, 0xEFCF6B }
--释放技能
color_jineng = { 0xFFDF73, -9, 1, 0xF7DB73, -5, 1, 0xF7DB73, -2, -10, 0xF7DB73, -3, 16, 0xFFDB73, 3, 21, 0xFFDB73, -2, 40, 0xFFDF73, 5, 40, 0xEFCB6B, 6, 66, 0xFFDB73, -8, 58, 0xF7D773 }
--主线任务
color_zhuxian = { 0xF7F3EF, -6, 0, 0xDEDBDE, 6, 1, 0xCECFCE, -2, -11, 0xFFFFFF, -7, -11, 0xFFFFFF, -3, 13, 0xFFFFFF, 4, 13, 0xFFFFFF }
--立即装备
color_liji = { 0xE7CF73, -13, 2, 0xF7D76B, -13, 18, 0xEFC763, -8, 12, 0xEFD373, -4, 12, 0xF7D773, -4, 17, 0xFFD773, -4, 17, 0xFFD773, -1, 21, 0xEFD36B, -1, 25, 0xE7C76B }
--提示点击角色
color_juese = { 0xFFDB73, -1, -6, 0xF7DB73, -10, -7, 0xF7DB73, -11, -2, 0xFFDB73, -11, 3, 0xFFDB73, -10, 8, 0xFFD773, -7, 8, 0xF7D773, -1, 8, 0xFFDF73, -3, 22, 0xF7DB73, 2, 22, 0xFFD773, -12, 22, 0xF7D773, -10, 30, 0xFFD773 }
--提示斗魂
color_douhun = { 0xFFDB73, 8, 0, 0xF7D773, 8, 9, 0xFFD773, 0, 9, 0xFFDB73, -4, 21, 0xFFD773, 5, 19, 0xF7DB73, 3, 35, 0xFFDB73, -2, 35, 0xF7D373, -8, 34, 0xEFD373, 8, 29, 0xF7D373 }
--提示斗魂修炼
color_xiulian = { 0xFFD773, 12, 4, 0xFFDB73, 10, 16, 0xFFD773, 1, 38, 0xF7D773, 9, 44, 0xF7D773, 10, 49, 0xF7DB73, 1, 49, 0xFFDB73, 6, 49, 0xF7DB73, 10, 49, 0xF7DB73 }
--点击斗魂修炼
color_douhunxiulian = { 0x4AEBFF, 8, 1, 0x84FFFF, 14, 1, 0x94FFFF, 5, -14, 0x73FFFF, -9, -16, 0x4AEBFF, -10, 3, 0x52FFFF, 0, 18, 0x52F7FF, 2, 23, 0x52EFFF, 8, 37, 0x6BF7FF, -9, 38, 0x4AFFFF }
--提示点开异常
color_richang = { 0xFFDB73, -1, 8, 0xFFDB73, -1, -6, 0xFFD76B, -7, -6, 0xEFCB6B, -6, 8, 0xFFDB73, -11, 9, 0xF7D373, -3, 23, 0xFFDB73, 2, 23, 0xFFDB73, -12, 23, 0xFFD773, -12, 15, 0xFFDB73, -13, 30, 0xFFDB6B, -4, 40, 0xFFDB73 }
--提示进入死亡矿洞提示
color_kuangdong = { 0xF7D76B, -1, 5, 0xE7C36B, -7, 3, 0xF7D773, -5, 9, 0xFFDB73, 4, 29, 0xDEC363, 1, 22, 0xF7D773, -12, 22, 0xF7D36B, -2, 43, 0xF7D773, -10, 43, 0xEFCF6B, 5, 55, 0xDEBE63, 5, 69, 0xFFD773, 5, 81, 0xF7D373 }
--提示开始挑战
color_tiaozhan = { 0xF7D373, -6, 4, 0xF7D773, -10, 0, 0xFFD773, -11, 8, 0xEFD36B, -1, 25, 0xFFD76B, -10, 26, 0xF7D773, -14, 26, 0xDEC36B, 1, 42, 0xF7D773, -6, 42, 0xF7D773, 1, 50, 0xFFDB73, -6, 55, 0xE7CB6B }
--提示进入幻境罗盘
color_luopan = { 0xF7D773, -7, 4, 0xFFDB73, 7, 13, 0xFFDB73, 3, 19, 0xFFDB73, -6, 19, 0xF7D773, -7, 27, 0xFFDB73, 4, 27, 0xFFDB73, 3, 46, 0xF7DB73, 0, 45, 0xF7DB73 }
--提示选择幻境罗盘难度
color_luopannandu = { 0xFFDB73, -4, 0, 0xFFDB73, 4, 15, 0xF7D773, 6, 33, 0xF7DB73, -3, 33, 0xF7D373, 0, 56, 0xFFD773, 6, 62, 0xF7D36B, 4, 67, 0xF7DB73, -1, 67, 0xFFDB73, 10, 68, 0xF7CF6B }
--提示进入幻境罗盘副本
color_jinruhuanjing = { 0xE7CB6B, -6, 0, 0xFFD773, -12, 0, 0xF7D36B, -7, -12, 0xE7CB6B, -2, -10, 0xEFCF6B, 1, 1, 0xF7D36B, -4, 14, 0xF7D36B, -13, 13, 0xEFCF6B, -10, 25, 0xE7CB73, 5, 22, 0xEFCF73 }
--提示点击风云争霸
color_fengyun = { 0xEFCB6B, 9, 6, 0xE7C76B, 9, -7, 0xDEBE63, 2, 20, 0xF7D36B, -5, 28, 0xF7D773, 6, 37, 0xF7D773, 3, 37, 0xFFD76B, 0, 45, 0xEFD373 }
--提示查看风云信息
color_xinxi = { 0xF7CF6B, 0, 13, 0xF7D773, 11, 5, 0xFFDF73, -6, 2, 0xFFD773, -5, 12, 0xF7D773, -2, 6, 0xF7D373, -7, -18, 0xFFDF73, -6, -7, 0xFFDB73, 11, -13, 0xFFDB73 }
--提示擂台挑战
color_fengyuntiaozhan = { 0xFFDB73, 6, 0, 0xFFDB73, 6, 4, 0xFFDB73, 6, 17, 0xFFDF73, -9, 16, 0xFFDB73, -2, 16, 0xFFDB73, -2, 5, 0xFFDF73, -9, 5, 0xFFDB73, -8, 24, 0xF7CF6B, -2, 36, 0xFFDB73, -8, 36, 0xFFDB73 }
--领取擂台奖励
color_leitaijiangli = { 0xFFD773, 5, 0, 0xF7DB73, 11, 1, 0xFFD76B, 12, 15, 0xF7DB73, -4, 13, 0xF7DB73, -2, 25, 0xFFDB73, 10, 30, 0xEFCB6B, 7, 30, 0xF7DB73, 7, 19, 0xFFD76B, 5, 19, 0xFFD76B }
--提示返回斗气大陆
color_fanhuidalu = { 0xFFD76B, -10, 17, 0xEFCF6B, -12, 21, 0xE7C76B, -12, 26, 0xE7C76B, -13, 30, 0xE7CB6B, -3, 26, 0xEFD373, 2, 26, 0xF7D36B }
--提示悬赏任务
color_xuanshang = { 0xCEBA6B, 12, -5, 0xD6B663, 12, 0, 0xE7CB6B, 8, 15, 0xFFDB73, 5, 25, 0xE7CB6B, -3, 25, 0xD6C36B, 2, 42, 0xEFD373, 7, 43, 0xE7CB6B }
--提示悬赏提升星级
color_tisheng = { 0xF7D773, -4, 0, 0xF7DB73, -4, 7, 0xF7D773, 8, 17, 0xEFCF6B, -6, 17, 0xF7D36B, -6, 22, 0xF7D773, 1, 22, 0xFFD76B, 1, 26, 0xF7D76B, 6, 32, 0xF7DB73 }
--获得新物品使用
color_huode = { 0xFFFFFF, 7, -7, 0xF7FFFF, 7, 0, 0xFFFBFF, 1, 10, 0xFFFBFF, -1, 23, 0xF7FBFF, 5, 24, 0xE7EBEF }
--等级礼包
color_dengjilibao = { 0xBD1463, 32, 29, 0x9C5900, 79, 66, 0xBD2829, 82, 71, 0xD63C42, 85, 68, 0xE75152, 85, 67, 0xEF514A, 76, 72, 0xC60C08, 73, 72, 0xDEC7C6, 70, 70, 0xAD2C21, 77, 73, 0xC62021 }
--满斗气
color_mandouqi = { 0xDEC739, -4, 6, 0xFFD329, -4, -4, 0xD6BA29, -7, -5, 0xEFCF29, -2, 17, 0xF7CB21, 2, 17, 0xF7CB21, -1, 27, 0xF7CF21, -7, 27, 0xE7CF31, 3, 38, 0xF7CF21 }
--点击斗魂修炼
color_douhunxiulian = { 0x4AEBFF, 8, 1, 0x84FFFF, 14, 1, 0x94FFFF, 5, -14, 0x73FFFF, -9, -16, 0x4AEBFF, -10, 3, 0x52FFFF, 0, 18, 0x52F7FF, 2, 23, 0x52EFFF, 8, 37, 0x6BF7FF, -9, 38, 0x4AFFFF }
--任务中的悬赏
color_xsrw = { 0xE7E7E7, 6, -4, 0xFFFFFF, 9, -7, 0xEFF3EF, 9, 8, 0xFFFBF7, 7, 5, 0xFFFFFF, 4, -14, 0xE7EBEF, 8, -12, 0xF7FBFF, 8, -23, 0xFFFBFF, -1, -21, 0xF7FBFF, -2, -25, 0xEFEBEF }
--退出队伍
color_tuichuduiwu = { 0x84DFF7, 10, 6, 0x84DFF7, -5, -9, 0x8CDFEF, -13, -12, 0x7BC7DE, -8, 13, 0x84DFF7, 0, 14, 0x84E7FF, 8, 14, 0x84E7F7, 5, 2, 0x84E3EF, 1, 0, 0x84DFEF, -5, -5, 0x8CDFEF, -5, -10, 0x8CDFE7, -10, 1, 0x8CEBF7, 13, 0, 0x84CFE7 }
--神灯免费
color_mianfei = { 0xF7F3EF, 8, 4, 0xFFFBF7, 8, -2, 0xE7E7E7, 5, -5, 0xF7F7F7, 0, 14, 0xF7F3EF, 0, 24, 0xE7E3DE, -4, 19, 0xE7EFEF, -6, 14, 0xE7E7E7 }
--好友请求界面裕仁结尾
color_yurenqingqiu = { 0xFFFBFF, -5, -2, 0xFFFFFF, -13, 5, 0xE7E3DE, -13, 12, 0xF7FFFF, -8, 12, 0xF7F7F7, -3, 18, 0xF7FBF7, 1, 19, 0xF7F3EF }
--裕仁结尾
color_yuren = { 0xE7E7E7, -9, 0, 0xFFFFFF, -11, 6, 0xF7FBF7, -16, 6, 0xF7F7F7, -8, 19, 0xF7FBFF, -5, 22, 0xFFFFFF, -3, 11, 0xFFF7F7, 1, 8, 0xF7FBF7 }
--神灯免费
color_mianfei = { 0xF7F7F7, 0, 6, 0xDEE3E7, -5, 5, 0xF7F3EF, -11, -1, 0xE7EBE7, -5, 29, 0xE7E3DE, 3, 27, 0xE7E3E7, 1, 27, 0xEFEBE7, 3, 3, 0xE7E7E7, 0, 0, 0xF7F7F7, -2, 27, 0xE7EFEF }
--设置
color_shezhi = { 0x5ABEDE, -1, -9, 0x5AB6D6, 16, 2, 0xC6FBFF, -2, 10, 0x52B2DE, -7, 1, 0x52B2D6, 7, 4, 0xA5E7F7, 11, 10, 0xCEF7FF, -1, 11, 0x5AB6D6, 10, -9, 0xCEF7F7, 1, 4, 0x6BBEDE }
--收邮件
color_sendEmail = { 0xF7F7F7, 0, 5, 0xEFF3F7, 2, -11, 0xDEE7EF, -5, -23, 0xE7EFEF, 1, -23, 0xEFEFF7, 0, -33, 0xDEE7EF, -10, -36, 0xF7F7F7, -2, -40, 0xF7F7F7 }
--点击兑换
color_duihuan = { 0xADEBEF, 6, -9, 0xA5EFF7, -5, 6, 0x9CE7F7, -2, 20, 0xB5F3FF, 4, 20, 0xADEFF7 }
--兑换讨伐令
color_duihuantfl = { 0x42AACE, 2, -29, 0x39AED6, 10, -25, 0x3192B5, 11, 34, 0x319ABD }
--断开连接
color_duankailianjie = { 0xF7FFFF, -7, 35, 0xF7FBFF, 3, -53, 0xF7FFFF, -1, 103, 0xFFFFFF, -4, 93, 0xFFFBFF }
--侦查任务
color_zhencha = { 0xE7E3E7, -8, -1, 0xEFF3F7, -1, -9, 0xFFF7F7, -2, 4, 0xFFFBFF, 3, 0, 0xEFF3EF, 3, 0, 0xEFF3EF, 3, 0, 0xEFF3EF }
--断网重试
color_chongshi = { 0xA5E7EF, 8, -1, 0xA5EBF7, 11, 0, 0xADEFF7, -5, -1, 0x9CD3DE, 2, 19, 0xADF7FF, -4, 19, 0xA5E7EF }
--退出副本
color_tuichufuben = { 0x94F7F7, -2, 0, 0x8CDFEF, -5, -13, 0x7BC7CE, -6, 3, 0x84D7E7, -5, -9, 0x7BE3E7, -4, -8, 0x84E3E7, -2, -7, 0x84EBEF, -2, -3, 0x84EBEF }
--领取45级
color_45ji = { 0x9CDBE7, 9, 8, 0xADF3FF, 4, 38, 0x94C7CE, 0, 53, 0xA5EBF7, -2, 65, 0xA5E3EF, 4, 61, 0xADF7FF, 18, 72, 0xEFC7C6, 15, 75, 0xCED3D6, 22, 77, 0xD64142, 23, 80, 0xDE4142 }
--领取60级装备
color_60ji = { 0xADF3FF, 2, -29, 0xA5EBF7, -2, -6, 0xA5E3EF, -3, 24, 0xA5DFEF, -3, 37, 0xA5E3EF, 16, 44, 0x6B616B, 14, 47, 0xCED3D6, 18, 47, 0xBD2421, 21, 52, 0xD63839 }
--领取70级装备
color_70ji = { 0xADEFF7, 3, -14, 0xADF3FF, 8, -14, 0xB5F3FF, 0, 0, 0xADEFF7, 21, 54, 0xC63839, 18, 54, 0xC61010, 17, 51, 0xD69E9C, 24, 50, 0xEFD3CE, 27, 59, 0xDEAEAD, 18, 62, 0xDEC3BD, 20, 55, 0xC62C29 }
--萧家族地
color_xiaojia = { 0xEFEFEF, 0, 6, 0xEFEFEF, -5, 19, 0xF7F3F7, -14, 21, 0xE7EFF7, -14, 19, 0xE7EFEF, -8, 22, 0xEFEFEF, -5, 19, 0xF7F3F7, -5, 3, 0xE7EFEF, -7, 3, 0xEFEFEF }
--邂逅一次
color_xiehouyici = { 0xF7F3F7, -3, -17, 0xFFFFFF, 1, -17, 0xFFFFFF, 8, -19, 0xF7FBFF, -2, 40, 0xFFFBFF, 21, 73, 0xCE3431, 22, 66, 0xDE3839, 13, 68, 0xBDA6A5, 15, 64, 0xDECBCE, 28, 65, 0xCECFCE, 19, 67, 0xC62821 }
--地图药品商人
color_ditushangren = { 0xEFF3EF, -13, -31, 0xF7F3EF, -3, -31, 0xEFEFEF, 1, -26, 0xCECFCE, -12, -21, 0xEFEFF7, -13, -14, 0xE7EFEF, -8, -13, 0xE7E7E7, -1, -10, 0xEFEFEF, -9, -5, 0xF7F3EF, -8, 3, 0x8C969C }
--点击药数量输入框
color_yaoshurukuang = { 0xD6DFDE, 5, -4, 0xFFFBFF, 6, -1, 0xFFFFF7, -9, 0, 0xEFEBEF, -9, -3, 0xE7EBEF, -9, 3, 0xE7EBEF }
--已绑定
color_bangding = { 0xFFFFFF, -6, 0, 0xF7FBFF, -9, 3, 0xE7EBEF, -9, 12, 0xEFEBE7, -5, 15, 0xFFFFFF, 0, 13, 0xFFFFFF, 4, 13, 0xFFFFFF }
--任务设置
color_renwushezhi = { 0x8CDFEF, -6, -1, 0x84E7F7, -2, -11, 0x84E3F7, 10, -19, 0x8CEBF7, 15, -1, 0x8CEBEF, 10, 7, 0x84E3EF, -2, 5, 0x84E7EF }
--背包使用次数
beibaoshu = 0
--设置红蓝条
hlshu = 0
--主函数
function main()
---[[  
    mSleep(5000)
    
    
    
    --解锁
    jiesuo()
    --开始主线
    zhuxian()
    --奇遇
    qiyu()
    --征友
    zhengyou()
    --清理背包1次
    clearBag()
    --卖掉所有装备
    maizhuangbei()
    maiyao()
    --异常判断
    exception()
    --紫金山谷副本简单级别
    shangu()
    --异常判断
    exception()
    --领奖与锻炉.招财
    qiyu()
    --异常判断
    exception()
    --修炼斗气
    douqi()
    --异常判断
    exception()
    --关闭弹窗
    guanbi()
    --悬赏
    xuanshang()
    --异常判断
    exception()
    maiyao()
    --罗盘副本困难级别
    luopan()
    --清理背包2次
    clearBag()
    --异常判断
    exception()
    --异常判断
    exception()
    --侦查
    zhencha()
    --异常判断
    exception()
    --兑换令牌
    duihuanlingpai()
    --end
--]]
    mSleep(5000)
    --duihuanlingpai()
    while true do
        notifyMessage("全部任务已完成")
        mSleep(1500)
    end
end
---[[
--卖掉所有装备
function maizhuangbei()
    --关闭
    guanbi()
    --后台到前台
    qiantai()
    exception()
    --点击挂机
    findMuColortf(color_guaji,90, 308,1040, 390,1131)
    --打开背包
    if findPic_boolean("beibao.bmp",90,   4,531 ,  57,594 ) then
        click(x,y)
        --点击随身商店
        findPic("suishenshangdian.bmp",90,   3,822 ,  94,983 )
        --点击出售白装提示
        findPictf("baizhuangqueding.bmp",90, 193,407 , 263,543 )
        if findPic_boolean("quanbu.bmp",90, 539,647 , 581,742 ) then
            --点击装备
            clicktf( 557,805 )
        end
        --点击批量处理
        findPictf("piliangzhuangbei.bmp",90,  16,674 ,  64,720 )
        local hh = 0
        local lh = 0
        local chushoushu = 0
        --点击随身商店
        findPic("suishenshangdian.bmp",90,   3,822 ,  94,983 )
        --点击出售白装提示
        findPictf("baizhuangqueding.bmp",90, 193,407 , 263,543 )
        mSleep(2000)
        while hh < 4 do
            --取消传承
            findPiclp("quxiaochuancheng.bmp",90, 196,603 , 259,720 )
            --判断是否在背包界面
            if not findPic_boolean("shuaxin.bmp",90, 502,156 , 575,293 )and 
            not findPic_boolean("guanbixianshi.bmp",90, 390,194 , 635,405 )then
                --取消显示
                findPictf("guanbixianshi.bmp",90, 390,194 , 635,405 )
                --关闭背包界面
                findPic("guanbibeibao.bmp",90, 582,1074, 639,1134)
                notifyMessage("不在背包界面退出背包清理")
                logD("不在背包界面退出背包清理")
                mSleep(1500)
                return
            end
            --l相隔12            --h相隔8
            --行方向间隔101      --列方向102
            --起始范围  428,560         结束范围     525,660
            --第一个格子坐标    橙色  0xFFFFB5    紫色为 0xE751E7    蓝色  0xC6DBEF   绿色   0x29D7BD     
            if findOneColor_boolean(0xFFFFB5,85,428-lh*102,560 +hh*101,525-lh*102,660+hh*101) or 
            findOneColor_boolean(0xE751E7,85,428-lh*102,560 +hh*101,525-lh*102,660+hh*101) or 
            findOneColor_boolean(0xC6DBEF,85,428-lh*102,560 +hh*101,525-lh*102,660+hh*101) or 
            findOneColor_boolean(0x29D7BD,85,428-lh*102,560 +hh*101,525-lh*102,660+hh*101) then
                clicktf(x,y)
            else
                chushoushu = chushoushu +1
                --出售所有装备
                findPictf("chushouzhuangbei.bmp",90,   7,832 ,  73,947 )
                --确定出售
                findPictf("quedingchushou.bmp",90, 207,431 , 250,524 )
                if chushoushu >=3 then
                    --取消显示
                    findPictf("guanbixianshi.bmp",90, 390,194 , 635,405 )
                    --关闭背包界面
                    findPic("guanbibeibao.bmp",90, 582,1074, 639,1134)
                    notifyMessage("已全部清空")
                    logD("已全部清空")
                    mSleep(1500)
                    return
                end
            end
            hh = hh + 1
            if hh>=4 then
                hh = 0
                lh = lh+1
            end
            if lh>=4 then
                mSleep(500)
                lh = 0
                hh = 0
                --滑动屏幕
                myMove_RL( 159,736 ,1200,778,20)
            end
        end

    end
end
--]]
--判断时光令牌是否多余100
function panduanlingpai()
    --点击挂机
    findMuColortf(color_guaji,90, 308,1040, 390,1131)
    notifyMessage("判断令牌数")
    mSleep(1500)
    logD("判断令牌数")
    for i = 1,2 do
        --打开背包
        if findPic_boolean("beibao.bmp",90,   4,531 ,  57,594 ) then
            click(x,y)
            mSleep(2000)
            --点击随身商店
            findPic("suishenshangdian.bmp",90,   3,822 ,  94,983 )
            --点击出售白装提示
            findPictf("baizhuangqueding.bmp",90, 193,407 , 263,543 )
            local hh = 0
            local lh = 0
            local beibaojiemian = 0
            --时光令牌数
            local lingpaishu = 0
            --下拉次数
            local counts = 0
            --扩包点击次数
            local kuobaoshu = 0
            while hh < 4 do
                findPictf("beibao.bmp",90,   4,531 ,  57,594 )
                --判断是否在背包界面
                if not findPic_boolean("shuaxin.bmp",90, 502,156 , 575,293 )and 
                not findPic_boolean("guanbixianshi.bmp",90, 390,194 , 635,405 )then
                    beibaojiemian = beibaojiemian +1
                    --取消显示
                    findPictf("guanbixianshi.bmp",90, 390,194 , 635,405 )
                    if beibaojiemian >3 then
                        --关闭背包界面
                        findPic("guanbibeibao.bmp",90, 582,1074, 639,1134)
                        notifyMessage("不在背包界面退出背包清理")
                        logD("不在背包界面退出背包清理")
                        mSleep(1500)
                        beibaojiemian = 0
                        break
                    end
                end
                --l相隔12            --h相隔8
                --行方向间隔101      --列方向102
                --起始范围  428,560         结束范围     525,660
                --第一个格子坐标    橙色  0xFFFFB5    紫色为 0xE751E7    蓝色  0xC6DBEF   绿色   0x29D7BD     
                if findOneColor_boolean(0xFFFFB5,85,428-lh*102,560 +hh*101,525-lh*102,660+hh*101) or 
                findOneColor_boolean(0xE751E7,85,428-lh*102,560 +hh*101,525-lh*102,660+hh*101) or 
                findOneColor_boolean(0xC6DBEF,85,428-lh*102,560 +hh*101,525-lh*102,660+hh*101) or 
                findOneColor_boolean(0x29D7BD,85,428-lh*102,560 +hh*101,525-lh*102,660+hh*101) then
                    clicktf(x,y)
                    --如果是1级装备
                    if findPic_boolean("1jizhuangbei.bmp",90, 505,73  , 567,187 )then
                        --卖出装备
                        findPictf("maichuzhuangbei.bmp",90,  15,38  ,  63,142 )
                        --取消显示
                        findPictf("guanbixianshi.bmp",90, 390,194 , 635,405 )
                    end
                    --如果是时光令牌
                    if findPic_boolean("lingpaixianshi.bmp",90, 439,12  , 522,101 ) then
                        --判断是否有100个令牌
                        --if findPicLostColor_boolean("lingpaigeshu.bmp",90, 443,250 , 461,254,0xFF00FF )then
                        lingpaishu = lingpaishu +1
                        --令牌数判断
                        if lingpaishu >1 then
                            --取消显示
                            findPictf("guanbixianshi.bmp",90, 390,194 , 635,405 )
                            --关闭背包
                            findPic("guanbibeibao.bmp",90, 568,1051, 639,1131)
                            notifyMessage("令牌数大于100")
                            logD("令牌数大于100")
                            mSleep(1500)
                            --取消显示
                            findPictf("guanbixianshi.bmp",90, 390,194 , 635,405 )
                            --关闭背包
                            findPic("guanbibeibao.bmp",90, 568,1051, 639,1131)
                            return
                        end
                        --end
                    else
                        --取消显示
                        if findPic_boolean("guanbixianshi.bmp",90, 390,194 , 635,405 )then
                            clicktf(x,y)
                        end
                    end
                else
                    --点击格子
                    clickDialog(428-lh*102,560 +hh*101,525-lh*102,660+hh*101)
                    --开启背包提示
                    if findPic_boolean("kaiqibeibao.bmp",90, 409,517 , 447,620 ) then
                        logD("扩包次数甲乙")
                        mSleep(1500)
                        --取消自动购买
                        findPicTime("kuobaogoumai.bmp",90, 297,659 , 348,722 )
                        --点击确定扩包
                        findPic("quedingkuobao.bmp",90, 200,421 , 256,533 )
                        if kuobaoshu >2 then
                            --关闭背包
                            findPic("guanbibeibao.bmp",90, 568,1051, 639,1131)
                            notifyMessage("扩包次数一刀")
                            logD("扩包次数一刀")
                            mSleep(1500)
                            break
                        end
                        kuobaoshu = kuobaoshu +1
                    end
                end
                hh = hh + 1
                if hh>=4 then
                    hh = 0
                    lh = lh+1
                end
                if lh>=4 then
                    mSleep(500)
                    lh = 0
                    hh = 0
                    --滑动屏幕
                    myMove_RL( 159,736 ,1200,778,20)
                    counts = counts +1
                end
                if counts >=5 then
                    notifyMessage("背包完毕")
                    mSleep(1500)
                    --关闭背包
                    findPic("guanbibeibao.bmp",90, 568,1051, 639,1131)
                    counts = 0
                    break
                end
            end
            --令牌数判断
            if lingpaishu >1 then
                --取消显示
                findPictf("guanbixianshi.bmp",90, 390,194 , 635,405 )
                --关闭背包
                findPic("guanbibeibao.bmp",90, 568,1051, 639,1131)
                notifyMessage("令牌数大于100")
                logD("令牌数大于100")
                mSleep(1500)
                return
            else
                --取消显示
                findPictf("guanbixianshi.bmp",90, 390,194 , 635,405 )
                --关闭背包
                findPic("guanbibeibao.bmp",90, 568,1051, 639,1131)
                exception()
                duihuanlingpai()
                mSleep(40000)
            end
        end
    end
end
--读令牌参数
function readshiguang()
    local file,temp
    file = io.open("/var/touchelf/scripts/lingpai.txt","r")
    if file == nil then
        return -1
    end
    for line in file:lines() do
        temp = line
    end
    file:close()
    return temp
end
--侦查
function duihuanlingpai()
    --点击挂机
    findMuColortf(color_guaji,90, 308,1040, 390,1131)
    --关闭
    guanbi()
    --后台到前台
    qiantai()
    notifyMessage("开始兑换时光",2000)
    logD("开始兑换时光")
    mSleep(3000)
    --超时判断
    local time1 = os.time()
    local temp = readshiguang()
    if temp ~= "1" then
        while true do
            exception()
            --点击日常
            findPic("richang.bmp",90, 460,938 , 560,1043)
            --事务所
            findPic("shiwusuo.bmp",90,  61,633 , 282,855 )
            --领取讨伐奖励
            findPic("tfjiangli.bmp",90,  23,253 ,  74,383 )
            --兑换then
            if findMuColor_boolean(color_duihuan,90, 279,314 , 352,436 )then
                --点击兑换
                click(x,y)
                --点击时光令牌
                if findPic_boolean("shiguanglingpai.bmp",90, 183,616 , 236,675 )then
                    --点击兑换物品
                    click( 180,902 )
                end
            end
            if findPic_boolean("shiguang100.bmp",90, 284,487 , 321,534 ) then
                --确认兑换
                if findPic_boolean("duihuanshiguang.bmp",90, 179,526 , 219,623 ) then
                    click(x,y)
                    if not findPic_boolean("duihuanshiguang.bmp",90, 179,526 , 219,623 ) then
                        --关闭兑换
                        findPictf("guanbiduihuanlp.bmp",90, 452,679 , 503,732 )
                        --关闭兑换界面
                        findPic("guanbiduihuan.bmp",90, 559,1055, 639,1134)
                        notifyMessage("时光兑换完毕",300)
                        logD("时光兑换完毕")
                        mSleep(1000)
                        
                        local file = assert(io.open("/var/touchelf/scripts/lingpai.txt", 'w'))
                        --写入时光参数
                        file:write("1")
                        file:close()
                        mSleep(5500)
                        return
                    end
                end
                --点击加数量
            elseif findPic_boolean("jiashuliang.bmp",90, 298,599 , 312,613 )then
                clickDialog(x,y)
            end
            local time2 = os.time()
            if time2 - time1 >120 then
                --关闭兑换
                findPictf("guanbiduihuanlp.bmp",90, 452,679 , 503,732 )
                --关闭兑换界面
                findPic("guanbiduihuan.bmp",90, 559,1055, 639,1134)
                mSleep(1500)
                --重启游戏
                time1 = os.time()
                notifyMessage("兑换令牌超时")
                logD("兑换令牌超时")
                appKill("com.idreamsky.cqb.pp")
                mSleep(4000)
                appRun("com.idreamsky.cqb.pp")
                mSleep(5000)
            end
        end
    else
        notifyMessage("已兑换过")
        logD("已兑换过")
        mSleep(2000)
    end
end
--加好友
function zhengyou()
    --点击挂机
    findMuColortf(color_guaji,90, 308,1040, 390,1131)
    --关闭
    guanbi()
    exception()
    mSleep(2000)
    --获取焦点
    qiantai()
    --打开背包
    if findPic_boolean("beibao.bmp",90,   2,534 ,  57,598 ) then
        --打开背包
        click(x,y)
        --打开功能系统
        click( 455,12)
    end
    --点击好友
    if findPic_boolean("haoyou.bmp",90, 425,532 , 491,590 )then
        click(x,y)
    end
    --点击征友
    if findPic_boolean("haoyoubiaoqian.bmp",90, 532,184 , 573,261 )then
        notifyMessage("开始征友")
        logD("开始征友")
        mSleep(1500)
        for i= 1,6 do
            --点击一键征友
            clicktf( 556,442 )
            --全部添加
            findPic("quantianjia.bmp",90,  25,855 ,  66,968 )
            --点击好友
            click( 553,219 )
        end
        --关闭征友界面
        findPic("guanbizhengyou.bmp",90, 583,1074, 639,1133)
    end
    --关闭征友界面
    findPic("guanbizhengyou.bmp",90, 583,1074, 639,1133)
    mSleep(1500)
end
--紫金山谷副本简单级别
function shangu()
    --点击挂机
    findMuColortf(color_guaji,90, 308,1040, 390,1131)
    --关闭
    guanbi()
    mSleep(2000)
    --获取焦点
    qiantai()
    --退队伍
    tuiDui()
    --开始紫金山谷
    mSleep(3000)
    --点击日常
    findPic("richang.bmp",90, 460,938 , 560,1043)
    --向右滑动
    findPic("xiangyou.bmp",85, 294,1073, 348,1114)
    --clicktf( 321,1100)
    --向右滑动
    findPic("xiangyou.bmp",85, 294,1073, 348,1114)
    --点击紫金山谷
    findPic("zijingshangu.bmp",90, 315,298 , 466,464 )
    --点击简单级别
    findPic("shangujiandan.bmp",90,  15,344 , 206,530 )
    --进入山谷副本
    if findPic_boolean("jinrufuben.bmp",90,   7,745 , 110,918 )then
        click(x,y)
        mSleep(2000)
        if findPic_boolean("jinrufuben.bmp",90,   7,745 , 110,918 )then
            notifyMessage("山谷副本次数已用完")
            logD("山谷副本次数已用完")
            mSleep(1500)
            --关闭副本进入界面
            findPic("guanbifuben.bmp",90, 578,1073, 638,1131)
            return
        end
    end
    --关闭副本进入界面
    findPic("guanbifuben.bmp",90, 578,1073, 638,1131)
    --点击挂机
    findMuColortf(color_guaji,90, 308,1040, 390,1131)
    --第一点时间
    time1 = os.time()
    while true do 
        --异常之类窗口
        exception()
        --点击挂机
        findMuColortf(color_guaji,90, 308,1040, 390,1131)
        --使用获得的物品
        findMuColortf(color_huode,90, 269,115 , 305,243 )
        --取消提示
        findPictf("quxiaots.bmp",90, 190,593 , 263,720 )
        --离开副本
        if findPicLostColor_boolean("likaifuben.bmp",90,  18,957 ,  70,1098,0xFF00FF) then
            notifyMessage("离开副本")
            logD("离开副本")
            mSleep(8000)

            for i = 1,10 do
                --使用获得的物品
                findMuColortf(color_huode,90, 269,115 , 305,243 )
                --取消传承
                if findPic_boolean("chuanchengjiemian.bmp",90, 407,535 , 444,602 )then
                    --取消传承
                    findPiclp("quxiaochuancheng.bmp",90, 196,603 , 259,720 )
                end
            end
            findPicLostColor("likaifuben.bmp",90,  18,957 ,  70,1098,0xFF00FF)
            notifyMessage("紫金山谷副本结束")
            mSleep(1500)
            logD("紫金山谷副本结束")
            mSleep(10000)
            return
        end
        --4分钟
        local timesg = os.time()
        if timesg%240 <5 and  not findPic_boolean("tuichufb.bmp",90, 509,1035, 567,1094)then
            --退队伍
            tuiDui()
            --开始紫金山谷
            mSleep(3000)
            --点击日常
            findPic("richang.bmp",90, 460,938 , 560,1043)
            --向右滑动
            findPic("xiangyou.bmp",85, 294,1073, 348,1114)
            --clicktf( 321,1100)
            --向右滑动
            findPic("xiangyou.bmp",85, 294,1073, 348,1114)
            if findPic_boolean("shangucishu.bmp",90, 327,355 , 374,429 )then
                notifyMessage("紫金山谷次数已用完")
                logD("紫金山谷次数已用完")
                mSleep(2000)
                return
            end
            --点击紫金山谷
            findPic("zijingshangu.bmp",90, 315,298 , 466,464 )
            --点击简单级别
            findPic("shangujiandan.bmp",90,  15,344 , 206,530 )
            --进入副本
            findPic("jinrufuben.bmp",90,   7,745 , 110,918 )
            --关闭副本进入界面
            findPic("guanbifuben.bmp",90, 578,1073, 638,1131)
        end
        --副本超时 15分钟
        local time2 = os.time()
        if time2-time1 >900  then
            --退出副本
            findPictf("tuichufuben.bmp",85, 513,1038, 565,1090)
            findMuColortf(color_tuichufuben,90, 509,1035, 567,1094)
            --退出副本
            findMuColortf(color_tuichufuben,90, 509,1035, 567,1094)
            --退出副本
            findPictf("tuichufb.bmp",90, 509,1035, 567,1094)
            --确定退出
            findPictf("quedingtuichu.bmp",90, 207,434 , 246,521 )
            --确定退出
            findPictf("quedingtuichu.bmp",90, 207,434 , 246,521 )
            --确定退出
            findPictf("quedingtuichu.bmp",90, 207,434 , 246,521 )
            time1 = os.time()
            notifyMessage("副本超时")
            mSleep(1500)
            logD("副本超时")
            appKill("com.idreamsky.cqb.pp")
            mSleep(4000)
            appRun("com.idreamsky.cqb.pp")
            mSleep(5000)
            return
        end
    end
end
--调整红条蓝条
function honglan()
    if hlshu ==0 then
        --点击效果设置
        findPicLostColor("xiaoguoshezhi.bmp",85, 463,128 , 521,207 ,0xFF00FF)
        --点任务设置    没发现个人设置的话
        findMuColor(color_shezhi,90, 458,2, 533,77)
        --点击效果设置
        findPicLostColor("xiaoguoshezhi.bmp",85, 463,128 , 521,207 ,0xFF00FF)
        --判断是否在设置界面
        if findPic_boolean("baocunshezhi.bmp",90,   1,868 ,  61,980 )then
            --设置画面为简单
            clicktf( 403,473 )
            --点击红条
            clicktf( 288,542 )
            --点击蓝条
            clicktf( 203,488 )
            --保存设置
            findPic("baocunshezhi.bmp",90,   1,868 ,  61,980 )
            --确认保存设置
            findPic("querenbaocun.bmp",90, 200,422 , 259,536 )
            --关闭设置界面
            findPic("guanbishezhi.bmp",90, 578,1075, 639,1134)
            hlshu = hlshu +1
            mSleep(2000)
        end
        --关闭设置界面
        findPictf("guanbishezhi.bmp",90, 578,1075, 639,1134)
        mSleep(1000)
    end
end
--准备阶段,关闭一些
function zhunbei()
    exception()
    --关闭NPC
    findPictf("guanbicebianNPC.bmp",90, 585,281 , 638,333 )
    --关闭npc对话
    findPictf("guanbiNPC.bmp",90, 575,277 , 638,327 )
    --跳过动画和对话
    for i = 1,10 do
        findPicDialog("duihua.bmp",90,   1,1091,  33,1121)
    end
    --跳过动画
    findPicDialog("tiaoguo.bmp",90, 579,0   , 638,108 )
    touchDown(0,  66,112 )
    mSleep(500)
    touchUp(0)
    mSleep(500)
    --点击挂机
    findMuColortf(color_guaji,90, 308,1040, 390,1131)
end
--侦查
function zhencha()
    --点击挂机
    findMuColortf(color_guaji,90, 308,1040, 390,1131)
    --关闭
    guanbi()
    --后台到前台
    qiantai()
    notifyMessage("开始日常任务侦查",2000)
    logD("日常侦察任务开启")
    mSleep(3000)
    --点击日常
    findPic("richang.bmp",90, 460,938 , 560,1043)
    --事务所
    findPic("shiwusuo.bmp",90,  61,633 , 282,855 )
    --领取讨伐奖励
    findPic("tfjiangli.bmp",90,  23,253 ,  74,383 )
    if findMuColor_boolean(color_duihuan,90, 279,314 , 352,436 ) and
    not findPic_boolean("kaishizhencha.bmp",90,   3,819 ,  98,994 ) and
    not findPic_boolean("jixuzhencha.bmp",90,   4,825 ,  97,993 ) then
        notifyMessage("没有可做的侦查任务")
        mSleep(1500)
        logD("没有可做的侦查任务")
        --关闭事务所侦查界面
        findPic("guanbizhencha.bmp",90, 566,1066, 639,1133)
        return
    end
    --开始侦查
    findPic("kaishizhencha.bmp",90,   3,819 ,  98,994 )
    --如果已经开始那就是  继续侦查
    findPic("jixuzhencha.bmp",90,   4,825 ,  97,993 )
    --关闭事务所侦查界面
    findPic("guanbizhencha.bmp",90, 566,1066, 639,1133)
    --点开任务眼
    renwuzhencha()
    mSleep(5000)
    --买lan药时间
    local timely = os.time()
    --重置时间的条件
    local zhenchaTemp = 0
    --超时时间
    time1 = os.time()
    while true do
        --提交任务
        if findPic_boolean("tijiaorenwu.bmp",90,28,8, 126,323 )then
            clicklp(x,y)
            zhenchaTemp = zhenchaTemp +1

        end
        --接受任务
        if findPic_boolean("jieshourenwu.bmp",90,  34,9   , 127,325 )then
            clicklp(x,y)
            if zhenchaTemp >=1 then
                zhenchaTemp = 0
                --重置时间
                time1 = os.time()
            end
        end
        --间隔17分钟判断是否买药
        local timeyao = os.time()
        if timeyao - timely > 1740 then
            timely = os.time()
            --准备阶段
            zhunbei()
            mSleep(1000)
            --买药
            maiyao()
        end
        --奇遇  51分钟
        local timebb = os.time()
        if timebb%3060<40 then
            --准备阶段
            zhunbei()
            exception()
            mSleep(1000)
            --奇遇,领奖,神兵,锻炉,纳戒,清理背包
            qiyu()
            mSleep(5000)
        end

        --关闭全屏窗口
        findPiclp("guanbiditu.bmp",90, 571,1063, 638,1132)
        --设置红蓝条
        honglan()
        --断网等操作
        exception()
        --39,38级时清理一级装备使用药丸
        --yaowan()
        --角色进入
        findMuColorlp(color_juesejinru,90,   2,888 , 113,1130)
        --取消传承
        if findPic_boolean("chuanchengjiemian.bmp",90, 407,535 , 444,602 )then
            --取消传承
            findPiclp("quxiaochuancheng.bmp",90, 196,603 , 259,720 )
        end
        --关闭左边NPC对话
        if not findPicTime("tijiaorenwu.bmp",90,28,8, 126,323 )and
        not findPicTime("jieshourenwu.bmp",90,  34,9   , 127,325 )then
            findPiclp("guanbicebianNPC.bmp",90, 585,281 , 638,333 )
        end
        --间隔20
        local zcTime = os.time()
        if zcTime%20<=2 then
            --点开任务眼
            renwuzhencha()
        end
        --关闭配件
        findPiclp("guanbipeijian.bmp",90, 227,509 , 291,628 )
        --取消传承
        if findPic_boolean("chuanchengjiemian.bmp",90, 407,535 , 444,602 )then
            --取消传承
            findPiclp("quxiaochuancheng.bmp",90, 196,603 , 259,720 )
        end
        --提交任务
        if findPic_boolean("tijiaorenwu.bmp",90,28,8, 126,323 )then
            clicklp(x,y)
            zhenchaTemp = zhenchaTemp +1

        end
        --接受任务
        if findPic_boolean("jieshourenwu.bmp",90,  34,9   , 127,325 )then
            clicklp(x,y)
            if zhenchaTemp >=1 then
                zhenchaTemp = 0
                --重置时间
                time1 = os.time()
            end
        end
        --关闭npc对话
        findPiclp("guanbiNPC.bmp",90, 575,277 , 638,327 )
        --跳过动画
        findPiclp("tiaoguo.bmp",90, 579,0   , 638,108 )
        --关闭过场动画
        findPiclp("dianjijixu.bmp",90,   1,1079,  42,1129)
        --local time2 = os.time()
        --if time2%4<2 then
        --点击任务自动寻路侦查
        findMuColortf(color_zhencha,90, 248,10  , 368,188 )
        --end
        --使用获得的物品
        findMuColorlp(color_huode,90, 269,115 , 305,243 )
        --事务所
        findPictf("shiwusuo.bmp",90,  61,633 , 282,855 )
        --领取讨伐奖励
        findPictf("tfjiangli.bmp",90,  23,253 ,  74,383 )
        --开始侦查
        findPiclp("kaishizhencha.bmp",90,   3,819 ,  98,994 )
        --如果已经开始那就是  继续侦查
        findPiclp("jixuzhencha.bmp",90,   4,825 ,  97,993 )
        --关闭对话
        for i = 1,10 do
            findPiclp("duihua.bmp",90,   1,1091,  33,1121)
        end
        --后台到前台
        qiantai()
        --超过15分钟还没提交任务或接受任务就执行死机操作,重启机子
        local time2 = os.time()
        if (time2 - time1)>900 then
            --重置时间
            time1 = os.time()
            notifyMessage("进行重启",2000)
            mSleep(3000)
            logD("任务未接受提交重启操作")
            mSleep(1000)
            appKill("com.idreamsky.cqb.pp")
            mSleep(4000)
            appRun("com.idreamsky.cqb.pp")
            mSleep(5000)
        end
        ----[[
        --每过4分钟接受侦查
        local time4 = os.time()
        if time4%240 <7 then
            --关闭npc对话
            findPictf("guanbiNPC.bmp",90, 575,277 , 638,327 )
            --点击日常
            findPic("richang.bmp",90, 460,938 , 560,1043)
            --事务所
            findPic("shiwusuo.bmp",90,  61,633 , 282,855 )
            --领取讨伐奖励
            findPic("tfjiangli.bmp",90,   23,253 ,  74,383 )
            --[[
            if findMuColor_boolean(color_duihuan,90, 279,314 , 352,436 ) and
               not findPic_boolean("kaishizhencha.bmp",90,   3,819 ,  98,994 ) and
               not findPic_boolean("jixuzhencha.bmp",90,   4,825 ,  97,993 ) then
                notifyMessage("没有可做的侦查任务")
                mSleep(1500)
                logD("没有可做的侦查任务")
                --关闭事务所侦查界面
                findPic("guanbizhencha.bmp",90, 566,1066, 639,1133)
                return
            end
            --]]
            --开始侦查
            findPic("kaishizhencha.bmp",90,   3,819 ,  98,994 )
            --如果已经开始那就是  继续侦查
            findPic("jixuzhencha.bmp",90,   4,825 ,  97,993 )
            --关闭事务所侦查界面
            findPic("guanbizhencha.bmp",90, 566,1066, 639,1133)
        end
        --]]
        --案件完成时  下一个案件按钮
        if findPic_boolean("xiageanjian.bmp",90, 130,504 , 198,638 ) then
            logD("当前环侦查任务完成")
            mSleep(8000)
            --点击下个案件按钮
            clicktf(x,y)
            --换讨伐令
            --huantfl()
            --后台到前台
            qiantai()
            --点击日常
            findPic("richang.bmp",90, 460,938 , 560,1043)
            --事务所
            findPic("shiwusuo.bmp",90,  61,633 , 282,855 )
            --领取讨伐奖励
            findPic("tfjiangli.bmp",90,  23,253 ,  74,383 )
            --开始侦查
            findPic("kaishizhencha.bmp",90,   3,819 ,  98,994 )
            --如果已经开始那就是  继续侦查
            findPic("jixuzhencha.bmp",90,   4,825 ,  97,993 )
            --点开任务眼
            renwuzhencha()
            --关闭事务所侦查界面
            findPic("guanbizhencha.bmp",90, 566,1066, 639,1133)
            notifyMessage("开始下一环日常任务侦查",2000)
            logD("日常侦察任务开启")
            mSleep(3000)
        end
        --完成全部侦查案件
        if findPic_boolean("zhenchawan.bmp",90, 138,469 , 185,675 ) then
            click(x,y)
            notifyMessage("已完成150次侦查")
            mSleep(1500)
            logD("已完成150次侦查")
            --关闭事务所侦查界面
            findPic("guanbizhencha.bmp",90, 566,1066, 639,1133)
            return
        end
        --提交任务
        if findPic_boolean("tijiaorenwu.bmp",90,28,8, 126,323 )then
            clicklp(x,y)
            zhenchaTemp = zhenchaTemp +1

        end
        --接受任务
        if findPic_boolean("jieshourenwu.bmp",90,  34,9   , 127,325 )then
            clicklp(x,y)
            if zhenchaTemp >=1 then
                zhenchaTemp = 0
                --重置时间
                time1 = os.time()
            end
        end
        --关闭全屏窗口
        findPiclp("guanbiditu.bmp",90, 571,1063, 638,1132)
        --关闭地图
        findPiclp("guanbiditu1.bmp",90,571,1063, 638,1132)
        --关闭药店
        findPic("guanbiyaodian.bmp",90, 568,1058, 639,1134)

        --关闭等级礼包界面
        findPic("guanbilibao.bmp",90, 542,906 , 596,963 )
        --关闭7日签到界面
        findPic("guanbi7ri.bmp",90, 584,904 , 633,958 )
        --关闭30日签到
        findPic("guanbiqiandao.bmp",90, 557,841 , 612,904 )
    end
end
--异常与固定弹窗
function exception()
    --风云挑战失败离开
    findPic("likaifengyun.bmp",90,  18,529 ,  65,606 )
    --判断是否在登陆界面   移动pp图标
    if findPic_boolean("denglujiemian.bmp",90, 550,550 , 604,619 ) then
        --移动pp图标
        if findPicLostColor_boolean("pptubiao1.bmp",90, 481,63  , 567,159 ,0xFF00FF) then
            notifyMessage(x.."--"..y)
            logD("滑动屏幕")
            mSleep(1000)
            myMove_UD(x,y, 349,1105,10)
            mSleep(800)
            myMove_RL(520,1080, 434,1080,10)
            mSleep(1000)
        end
    end
    --越狱应用登陆界面
    if findPic_boolean("yueyudenglu.bmp",90, 209,520 , 268,614 ) then
        clicktf(x,y)
    end
    --成就
    if findPic_boolean("chengjiuxingxing.bmp",90, 284,595 , 325,636 )then
        clicktf(x,y)
        --领取成就
        findPicLostColor("chengjiulingqu.bmp",90, 430,840 , 485,948,0xFF00FF )
        --关闭成就界面
        findPiclp("guanbichengjiu.bmp",90, 582,1073, 639,1133)
    end
    --邀请拒绝
    if findPic_boolean("duiwuxiaoxi.bmp",90, 406,516 , 447,617 )then
        findPiclp("quxiaozudui.bmp",90, 202,604 , 258,713 )
    end
    --回城复活
    if findPic_boolean("huichengfuhuo.bmp",90, 197,441 , 248,548 )then
        clicklp(x,y)
    end
    --关闭充值
    if findPic_boolean("guanbichongzhi.bmp",90, 579,918 , 632,978 )then
        clicklp(x,y)
    end
    --手机安全模式提示
    if findPic_boolean("ok_safeMode.bmp",90, 173,503 , 245,616 )then
        clicklp(x,y)
    end
    --关闭配件
    if findPic_boolean("guanbipeijian.bmp",90, 227,509 , 291,628 )then
        clicklp(x,y)
    end
    --取消开启自动下载  
    if findPic_boolean("quxiaoIOS.bmp",90, 170,376 , 227,484 )then
        clicklp(x,y)
    end
    --领取红包
    if findPic_boolean("hongbao.bmp",90, 471,737 , 528,800 )then
        clicklp(x,y)
    end
    --取消网络选择
    if findPic_boolean("wangluoquxiao.bmp",90,  68,526 , 142,638 )then
        clicklp(x,y)
    end
    --账号界面登陆
    if findPic_boolean("denglu.bmp",90, 147,470 , 268,658 )then
        clicklp(x,y)
    end
    --立即登录
    if findPic_boolean("lijidenglu.bmp",90, 221,492 , 287,646 )then
        clicklp(x,y)
    end
    --断线登陆界面进入游戏    
    if findPic_boolean("jinruyouxi.bmp",90,  16,382 , 171,738 )then
        --移动pp图标
        if findPicLostColor_boolean("pptubiao1.bmp",90, 481,63  , 567,159 ,0xFF00FF) then
            notifyMessage(x.."--"..y)
            logD("滑动屏幕")
            mSleep(1000)
            myMove_UD(x,y, 349,1105,10)
            mSleep(800)
            myMove_RL(520,1080, 434,1080,10)
            mSleep(1000)
        end
        findPic("jinruyouxi.bmp",90,  16,382 , 171,738 )
    end
    if findPic_boolean("jinruyouxi_2.bmp",90,16,382 , 171,738 )then
        --移动pp图标
        if findPicLostColor_boolean("pptubiao1.bmp",90, 481,63  , 567,159 ,0xFF00FF) then
            notifyMessage(x.."--"..y)
            logD("滑动屏幕")
            mSleep(1000)
            myMove_UD(x,y, 349,1105,10)
            mSleep(800)
            myMove_RL(520,1080, 434,1080,10)
            mSleep(1000)
        end
        findPic("jinruyouxi_2.bmp",90,16,382 , 171,738 )
    end
    --全部领取
    if findPic_boolean("quanbulingqu.bmp",90,  43,471 , 150,655 )then
        clicklp(x,y)
    end
    --登陆错误
    if findPic_boolean("quedingcuowu.bmp",90, 204,498 , 276,625 )then
        clicklp(x,y)
    end
    if findPic_boolean("dlcwqd.bmp",90, 197,484 , 282,628 )then
        clicklp(x,y)
    end
    if findPic_boolean("denglucuowu_2.bmp",90, 200,510 , 283,621 )then
        clicklp(x,y)
    end
    --立即登录
    if findPic_boolean("lijidenglu.bmp",90, 221,492 , 287,646 )then
        clicklp(x,y)
    end
    --关闭离线挂机界面
    if findPic_boolean("guanbilixianguaji.bmp",90, 409,739 , 500,831 )then
        clicklp(x,y)
    end
    --角色进入
    if findMuColor_boolean(color_juesejinru,90,   2,888 , 113,1130)then
        clicklp(x,y)
    end
    --活动公告
    if findPic_boolean("huodong.bmp",90,  51,489 , 120,638 )then
        clicklp(x,y)
    end
    --精彩内容
    if findPic_boolean("jingcaineirong.bmp",90, 561,919 , 618,973 ) then
        clicklp(x,y)
    end
    --关闭离线挂机界面
    if findPic_boolean("guanbiguaji.bmp",90, 427,755 , 492,834 )then
        clicklp(x,y)
    end
    --横屏SIM卡提示
    findPic("SIMhao_hengp.bmp",90, 210,581 , 438,663 )
    --sim卡提示
    findPic("SIMhao.bmp",90, 208,385 , 313,821 )
    --取消家族boss提示
    --findPictf("jiazuboss.bmp",90, 193,595 , 267,727 )
    --取消家族boss进入提示
    --findPictf("bossjinru.bmp",90, 194,595 , 271,726 )
    --断网重试
    if findMuColor_boolean(color_chongshi, 90,259,502 , 329,628 )then
        clicklp(x,y)
    end
    --点击纳戒
    if findPic_boolean("najie.bmp",90, 192,20  , 286,127 )then
        clicklp(x,y)
    end
    --获得新物品
    if findMuColor_boolean(color_huode,90, 269,115 , 305,243 )then
        clicklp(x,y)
    end
    --取消传承
    if findPic_boolean("chuanchengjiemian.bmp",90, 407,535 , 444,602 )then
        --取消传承
        findPiclp("quxiaochuancheng.bmp",90, 196,603 , 259,720 )
    end
    --点开任务眼
    if not findMuColor_boolean(color_zhuxian,90, 342,74, 373,112 )then
        --点击打开任务眼
        findMuColorlp(color_renwu,90, 288,0, 408,94)
    end
    --退出角色界面
    if findPic_boolean("douhunxitong.bmp",90, 335,1, 584,195 ) or 
    findPic_boolean("beibaoxitong.bmp",90, 380,897 , 570,1132) then
        --退出界面
        clicklp( 618,24  )
    end
    --运行游戏
    if not appRunning("com.idreamsky.cqb.pp") then
        --启动游戏
        appRun("com.idreamsky.cqb.pp")
    end
    --[[
	--失去连接重启游戏
    if findMuColor_boolean(color_duankailianjie,90, 154,452 , 203,665 ) then
        --断网重试
        findMuColor(color_chongshi, 90,259,502 , 329,628 )
        mSleep(3000)
        if findMuColor_boolean(color_duankailianjie,90, 154,452 , 203,665 ) then
            logD("失去连接重启游戏")
            --关闭游戏在开启游戏
            appKill("com.idreamsky.cqb.pp")
            mSleep(4000)
            appRun("com.idreamsky.cqb.pp")
            mSleep(5000)  
        end
    end
    --]]
    --游戏获取焦点
    qiantai()
    --[[
	--连接资源
    if findPic_boolean("lianjieziyuan.bmp",90, 223,367 , 403,756 ) or 
       findPic_boolean("lianjieziyuan_1.bmp",90, 223,367 , 403,756 ) then
        mSleep(3000)
        if findPic_boolean("lianjieziyuan.bmp",90, 223,367 , 403,756 ) or 
           findPic_boolean("lianjieziyuan_1.bmp",90, 223,367 , 403,756 ) then
            logD("连接资源卡死。重启")
            --os.execute("reboot")
            --关闭游戏在开启游戏
            appKill("com.idreamsky.cqb.pp")
            mSleep(4000)
            appRun("com.idreamsky.cqb.pp")
            mSleep(5000)
        end
    end
	--登陆界面卡死，无账号区号信息
    if findPic_boolean("noaccount.bmp",90, 179,378 , 336,762 ) then
        logD("无账号区号信息卡死。重启")
        --关闭游戏在开启游戏
        appKill("com.idreamsky.cqb.pp")
        mSleep(4000)
        appRun("com.idreamsky.cqb.pp")
        mSleep(5000)
    end
    --]]
end
--[[
--元素试炼
function shilian()
    mSleep(2000)
    --后台到前台
    qiantai()
    --退出队伍
    tuiDui()
    --开始幻境罗盘
    mSleep(3000)
    --点击日常
    findPic("richang.bmp",90, 460,938 , 560,1043)
    --发现进入游戏   退出
    x,y = findMultiColorInRegionFuzzy(color_juesejinru,90,   2,888 , 113,1130)
    if x ~= -1 and y ~= -1 then
        return
    end
    --向右滑动
    findPic("xiangyou.bmp",85, 294,1073, 348,1114)
    --clicktf( 321,1100)
    --向右滑动
    findPic("xiangyou.bmp",85, 294,1073, 348,1114)
    
    
    
end
--浪漫邂逅
function xiehou()
    --后台到前台
    qiantai()
    notifyMessage("开始邂逅",2000)
    logD("开始邂逅")
    mSleep(3000)
    --点击奇遇
    findPic("qiyu.bmp",90, 452,878 , 554,985 )
    --浪漫邂逅
    findPic("xiehou.bmp",90, 469,525 , 568,617 )
    --免费
    if findMuColor_boolean(color_xiehouyici,90,  18,979 ,  87,1124) then
        click(x,y)
    end
    --再来一次 关闭
    if findPic_boolean("zailaiyici.bmp",90,  47,504 , 106,627 ) then
        click( 479,878 )
    end
    --关闭邂逅界面
    findPic("guanbixiehou.bmp",90, 580,1075, 639,1135)
end

--个人挑战
function gerentiaozhan()
    --开始个人挑战
    notifyMessage("开始个人挑战")
    mSleep(1500)
    local counts = 1
    while true do
        --点击日常
        findPic("richang.bmp",90, 460,938 , 560,1043)
        --个人挑战
        findPic("gerentiaozhan.bmp",90, 268,699 , 332,806 )
        --点击萧家族地
        findMuColor(color_xiaojia,90, 226,287 , 251,333 )
        if findPic_boolean("qianwangfuben.bmp",90,  23,845 ,  75,966 ) then
            table = {482,402,328,246}
            local suiji = math.random(1,4)
            if counts ==1 then
                click( 482,239 )
            elseif counts ==2 then
                click( 402,244 )
            elseif counts ==3 then
                click( 328,248 )
            elseif counts ==4 then
                click( 246,247 )
            elseif counts ==5 then
                index = table[suiji]
                click(index,245)
            end
            --前往副本
            findPic("qianwangfuben.bmp",90,  23,845 ,  75,966 )
            counts = counts +1
        end
        if counts >5 then
            notifyMessage("简单个人挑战完成")
            mSleep(1500)
            return
        end
        --挂机
        findMuColor(color_guaji,90, 308,1040, 390,1131)
        --使用获得物品
        findMuColor(color_huode,90, 269,115 , 305,243 )
        --离开副本
        findMuColor(color_likaifuben,90,  18,957 ,  70,1098)
    end
end

--风云争霸
function fengyun()
    --关闭
    guanbi()
    --退战
    tuizhan()
    notifyMessage("开始风云争霸")
    mSleep(1500)
    --点击日常
    findPic("richang.bmp",90, 460,938 , 560,1043)
    --风云争霸
    findPic("fengyun.bmp",90, 237,575 , 314,679 )
    while true do
        --挑战
        if findPic_boolean("tiaozhan.bmp",90, 166,507 , 221,629 ) then
            click(x,y)
            mSleep(5000)
            findPic("tiaozhan.bmp",90, 166,507 , 221,629 )
            if findPic_boolean("tiaozhan.bmp",90, 166,507 , 221,629 ) then
                --挑战次数已用完
                notifyMessage("挑战次数已用完")
                mSleep(1500)
                --关闭界面
                guanbi()
                return
            end
        end
        --失败就退出风云挑战
        if findPic_boolean("fengyunshibai.bmp",90, 500,473 , 604,668 ) then
            --退出风云争霸
            notifyMessage("失败退出风云争霸")
            mSleep(5000)
            --关闭风云界面
            guanbi()
            return
        end
        --点击挂机
        findMuColor(color_guaji,90, 308,1040, 390,1131)
    end
end
--]]
---[[清理背包和使用小药丸
function yaowan()

    if beibaoshu == 0 then
        zhunbei()
        local dengji = shibiedengji()
        if dengji == 39 then
            notifyMessage("开始吃药")
            mSleep(1500)
            logD("开始吃药")
            --打开背包
            if findPic_boolean("beibao.bmp",90,   4,531 ,  57,594 ) then
                click(x,y)
                if findPic_boolean("beibao.bmp",90,   4,531 ,  57,594 ) then
                    notifyMessage("未进入背包界面退出")
                    mSleep(1500)
                    logD("未进入背包界面退出")
                    --关闭背包
                    findPictf("guanbibeibao.bmp",90, 568,1051, 639,1131)
                    return
                end
                --点击随身商店
                findPic("suishenshangdian.bmp",90,   3,822 ,  94,983 )
                --点击出售白装提示
                findPictf("baizhuangqueding.bmp",90, 193,407 , 263,543 )
                local hh = 0
                local lh = 0
                --下拉次数
                local counts = 0
                --扩包点击次数
                local kuobaoshu = 0
                while hh < 4 do
                    --取消传承
                    findPiclp("quxiaochuancheng.bmp",90, 196,603 , 259,720 )
                    --判断是否在背包界面
                    if not findPic_boolean("shuaxin.bmp",90, 502,156 , 575,293 )and 
                    not findPic_boolean("guanbixianshi.bmp",90, 390,194 , 635,405 )then
                        --关闭背包界面
                        findPic("guanbibeibao.bmp",90, 582,1074, 639,1134)
                        notifyMessage("不在背包界面退出背包清理")
                        logD("不在背包界面退出背包清理")
                        mSleep(1500)
                        return
                    end
                    --l相隔12            --h相隔8
                    --行方向间隔101      --列方向102
                    --起始范围  428,560         结束范围     525,660
                    --第一个格子坐标    橙色  0xFFFFB5    紫色为 0xE751E7    蓝色  0xC6DBEF   绿色   0x29D7BD     
                    if findOneColor_boolean(0xFFFFB5,85,428-lh*102,560 +hh*101,525-lh*102,660+hh*101) or 
                    findOneColor_boolean(0xE751E7,85,428-lh*102,560 +hh*101,525-lh*102,660+hh*101) or 
                    findOneColor_boolean(0xC6DBEF,85,428-lh*102,560 +hh*101,525-lh*102,660+hh*101) or 
                    findOneColor_boolean(0x29D7BD,85,428-lh*102,560 +hh*101,525-lh*102,660+hh*101) then
                        clicktf(x,y)
                        --如果是40级药丸
                        if findPic_boolean("yaowan.bmp",90, 482,99  , 512,188 )then
                            --使用
                            findPicTime("shiyong.bmp",90,  90,197 , 128,282 )
                            notifyMessage("药丸一吃")
                            logD("药丸一吃")
                            mSleep(1500)
                        end
                        --如果是药品,讨伐令,钱币,铸灵碎片,悬赏令                      不处理的东西
                        if findPic_boolean("hongyao1.bmp",90, 440,14  , 513,92  ) or
                        findPic_boolean("hongyao2.bmp",90, 440,14  , 513,92  ) or
                        findPic_boolean("lanyao1.bmp",90, 440,14  , 513,92  ) or
                        findPic_boolean("lanyao2.bmp",90, 440,14  , 513,92  ) or
                        findPic_boolean("taofa.bmp",90, 440,14  , 513,92  ) or
                        findPic_boolean("qianbi.bmp",90, 440,14  , 513,92  ) or
                        findPic_boolean("zhuling.bmp",90, 482,99  , 512,188 ) or
                        findPic_boolean("kuobaojiejing.bmp",90, 482,99  , 512,188 ) or
                        findPic_boolean("xuanshangling",90, 443,19  , 511,90  )then
                            --取消显示
                            findPictf("guanbixianshi.bmp",90, 390,194 , 635,405 )
                        end
                        --如果是装备
                        if findPic_boolean("beibaozhuangbei.bmp",90, 596,104 , 628,205 ) then
                            --如果是1级装备
                            if findPic_boolean("1jizhuangbei.bmp",90, 440,14  , 513,92  )then
                                --卖出装备
                                findPictf("maichuzhuangbei.bmp",90,  15,38  ,  63,142 )
                            else
                                --取消显示
                                findPictf("guanbixianshi.bmp",90, 390,194 , 635,405 )
                            end
                        end
                        --绑定的东西                                         出售的东西
                        if findMuColor_boolean(color_bangding,90,5,2, 179,105 ) then
                            --如果不是装备
                            if not findPic_boolean("beibaozhuangbei.bmp",90, 596,104 , 628,205 ) then
                                --使用
                                findPicTime("shiyong.bmp",90,  90,197 , 128,282 )
                                --出售
                                --findPictf("chushou.bmp",90,  91,44  , 127,134 )
                                if findPic_boolean("lvsemohe.bmp",90, 482,210 , 514,267 ) then
                                    --熔炼
                                    findPictf("ronglian.bmp",90,  88,47  , 128,135 )
                                    --确定熔炼
                                    findPictf("quedingronglian.bmp",90, 205,430 , 249,523 )
                                end
                                --最大
                                findPicLostColor("zuida.bmp",90, 254,635 , 289,712,0xFF00FF )
                                --确认使用
                                findPicLostColor("querenshiyong.bmp",90, 164,517 , 198,620 ,0xFF00FF)
                                --取消显示
                                findPictf("guanbixianshi.bmp",90, 390,194 , 635,405 )
                                --确定组队
                                findPictf("chuanchengqueding.bmp",90, 209,435 , 246,517)
                            else
                                --卖出装备
                                findPictf("maichuzhuangbei.bmp",90,  15,38  ,  63,142 ) 
                            end
                        else
                            --取消显示
                            findPictf("guanbixianshi.bmp",90, 390,194 , 635,405 )
                        end
                    else
                        --点击格子
                        clickDialog(428-lh*102,560 +hh*101,525-lh*102,660+hh*101)
                        --开启背包提示
                        if findPic_boolean("kaiqibeibao.bmp",90, 409,517 , 447,620 ) then
                            logD("扩包次数甲乙")
                            mSleep(1500)
                            --取消自动购买
                            findPicTime("kuobaogoumai.bmp",90, 297,659 , 348,722 )
                            --点击确定扩包
                            findPic("quedingkuobao.bmp",90, 200,421 , 256,533 )
                            if kuobaoshu >2 then
                                beibaoshu = beibaoshu +1
                                --关闭背包
                                findPic("guanbibeibao.bmp",90, 568,1051, 639,1131)
                                notifyMessage("扩包次数一刀")
                                logD("扩包次数一刀")
                                mSleep(1500)
                                return
                            end
                            kuobaoshu = kuobaoshu +1
                        end
                    end
                    hh = hh + 1
                    if hh>=4 then
                        hh = 0
                        lh = lh+1
                    end
                    if lh>=4 then
                        mSleep(500)
                        lh = 0
                        hh = 0
                        --滑动屏幕
                        myMove_RL( 159,736 ,1200,778,20)
                        counts = counts +1
                    end
                    if counts >=5 then
                        notifyMessage("吃药完毕")
                        mSleep(1500)
                        --关闭背包
                        findPic("guanbibeibao.bmp",90, 568,1051, 639,1131)
                        return
                    end
                end
            end
        end
    end
end
--]]
---[[
--清理包裹
function clearBag()
    --锻炉
    duanlu()
    --点击挂机
    findMuColortf(color_guaji,90, 308,1040, 390,1131)
    notifyMessage("清理背包")
    mSleep(1500)
    logD("清理背包")
    --打开背包
    if findPic_boolean("beibao.bmp",90,   4,531 ,  57,594 ) then
        click(x,y)
        if findPic_boolean("beibao.bmp",90,   4,531 ,  57,594 ) then
            notifyMessage("未进入背包界面退出")
            mSleep(1500)
            logD("未进入背包界面退出")
            --关闭背包
            findPic("guanbibeibao.bmp",90, 568,1051, 639,1131)
            return
        end
        --点击随身商店
        findPic("suishenshangdian.bmp",90,   3,822 ,  94,983 )
        --点击出售白装提示
        findPictf("baizhuangqueding.bmp",90, 193,407 , 263,543 )
        local hh = 0
        local lh = 0
        --下拉次数
        local counts = 0
        --扩包点击次数
        local kuobaoshu = 0
        --不在背包界面计数
        local jishu = 0
        --点击随身商店
        findPic("suishenshangdian.bmp",90,   3,822 ,  94,983 )
        --点击出售白装提示
        findPictf("baizhuangqueding.bmp",90, 193,407 , 263,543 )
        mSleep(2000)
        while hh < 4 do
            --取消传承
            findPiclp("quxiaochuancheng.bmp",90, 196,603 , 259,720 )
            --判断是否在背包界面
            if not findPic_boolean("shuaxin.bmp",90, 502,156 , 575,293 )and 
            not findPic_boolean("guanbixianshi.bmp",90, 390,194 , 635,405 )then
                jishu = jishu +1
                if jishu >5 then
                    --取消显示
                    findPictf("guanbixianshi.bmp",90, 390,194 , 635,405 )
                    --关闭背包界面
                    findPic("guanbibeibao.bmp",90, 582,1074, 639,1134)
                    notifyMessage("不在背包界面退出背包清理")
                    logD("不在背包界面退出背包清理")
                    mSleep(1500)
                    return
                end
            end
            --l相隔12            --h相隔8
            --行方向间隔101      --列方向102
            --起始范围  428,560         结束范围     525,660
            --第一个格子坐标    橙色  0xFFFFB5    紫色为 0xE751E7    蓝色  0xC6DBEF   绿色   0x29D7BD     
            if findOneColor_boolean(0xFFFFB5,85,428-lh*102,560 +hh*101,525-lh*102,660+hh*101) or 
            findOneColor_boolean(0xE751E7,85,428-lh*102,560 +hh*101,525-lh*102,660+hh*101) or 
            findOneColor_boolean(0xC6DBEF,85,428-lh*102,560 +hh*101,525-lh*102,660+hh*101) or 
            findOneColor_boolean(0x29D7BD,85,428-lh*102,560 +hh*101,525-lh*102,660+hh*101) then
                clicktf(x,y)
                --如果是药品,讨伐令,钱币,铸灵碎片,悬赏令                      不处理的东西
                if findPic_boolean("hongyao1.bmp",90, 440,14  , 513,92  ) or
                findPic_boolean("hongyao2.bmp",90, 440,14  , 513,92  ) or
                findPic_boolean("lanyao1.bmp",90, 440,14  , 513,92  ) or
                findPic_boolean("lanyao2.bmp",90, 440,14  , 513,92  ) or
                findPic_boolean("taofa.bmp",90, 440,14  , 513,92  ) or
                findPic_boolean("qianbi.bmp",90, 440,14  , 513,92  ) or
                findPic_boolean("zhuling.bmp",90, 482,99  , 512,188 ) or 
                findPic_boolean("yaowan.bmp",90, 482,99  , 512,188 ) or
                findPic_boolean("kuobaojiejing.bmp",90, 482,99  , 512,188 ) or
                findPic_boolean("xuanshangling",90, 443,19  , 511,90  )then
                    --取消显示
                    findPictf("guanbixianshi.bmp",90, 390,194 , 635,405 )
                end
                --如果是装备
                if findPic_boolean("beibaozhuangbei.bmp",90, 596,104 , 628,205 )or
                findPic_boolean("beibaozhuangbei1.bmp",90, 583,2  ,  636,52 )then
                    --如果是1级装备
                    --if findPic_boolean("1jizhuangbei.bmp",90, 505,73  , 567,187 )then
                    --卖出装备
                    findPictf("maichuzhuangbei.bmp",90,  15,38  ,  63,142 )
                    --else
                    --取消显示
                    --findPictf("guanbixianshi.bmp",90, 390,194 , 635,405 )
                    --end
                end
                --绑定的东西                                         出售的东西
                if findMuColor_boolean(color_bangding,90,5,2, 179,105 ) then
                    --如果不是装备
                    if not findPic_boolean("beibaozhuangbei.bmp",90, 596,104 , 628,205 ) then
                        --使用
                        findPicTime("shiyong.bmp",90,  90,197 , 128,282 )
                        --出售
                        --findPictf("chushou.bmp",90,  91,44  , 127,134 )
                        if findPic_boolean("lvsemohe.bmp",90, 482,210 , 514,267 ) then
                            --熔炼
                            findPictf("ronglian.bmp",90,  88,47  , 128,135 )
                            --确定熔炼
                            findPictf("quedingronglian.bmp",90, 205,430 , 249,523 )
                        end
                        --最大
                        findPicLostColor("zuida.bmp",90, 254,635 , 289,712,0xFF00FF )
                        --确认使用
                        findPicLostColor("querenshiyong.bmp",90, 164,517 , 198,620 ,0xFF00FF)
                        --取消显示
                        findPictf("guanbixianshi.bmp",90, 390,194 , 635,405 )
                        --确定组队
                        findPictf("chuanchengqueding.bmp",90, 209,435 , 246,517 ) 
                    end
                else
                    --取消显示
                    findPictf("guanbixianshi.bmp",90, 390,194 , 635,405 )
                end
                --完成阅读
                findPictf("wanchengyuedu.bmp",90,  87,506 , 125,618 )
            else
                --点击格子
                clickDialog(428-lh*102,560 +hh*101,525-lh*102,660+hh*101)
                --开启背包提示
                if findPic_boolean("kaiqibeibao.bmp",90, 409,517 , 447,620 ) then
                    logD("扩包次数甲乙")
                    mSleep(1500)
                    --取消自动购买
                    findPicTime("kuobaogoumai.bmp",90, 297,659 , 348,722 )
                    --点击确定扩包
                    findPic("quedingkuobao.bmp",90, 200,421 , 256,533 )
                    if kuobaoshu >2 then
                        --关闭背包
                        findPic("guanbibeibao.bmp",90, 568,1051, 639,1131)
                        notifyMessage("扩包次数一刀")
                        logD("扩包次数一刀")
                        mSleep(1500)
                        return
                    end
                    kuobaoshu = kuobaoshu +1
                end
            end
            hh = hh + 1
            if hh>=4 then
                hh = 0
                lh = lh+1
            end
            if lh>=4 then
                mSleep(500)
                lh = 0
                hh = 0
                --滑动屏幕
                myMove_RL( 159,736 ,1200,778,20)
                counts = counts +1
            end
            if counts >=5 then
                notifyMessage("背包清理完毕")
                mSleep(1500)
                --关闭背包
                findPic("guanbibeibao.bmp",90, 568,1051, 639,1131)
                return
            end
        end
    end
end
--]]
--买药判定
function maiyao()
    --打开背包
    if findPic_boolean("beibao.bmp",90,   4,531 ,  57,594 ) then
        click(x,y)
        if findPic_boolean("beibao.bmp",90,   4,531 ,  57,594 ) then
            notifyMessage("未进入背包界面退出")
            mSleep(1500)
            logD("未进入背包界面退出")
            --关闭背包
            findPic("guanbibeibao.bmp",90, 568,1051, 639,1131)
            return
        end
        --点击随身商店
        findPic("suishenshangdian.bmp",90,   3,822 ,  94,983 )
        --点击出售白装提示
        findPic("baizhuangqueding.bmp",90, 193,407 , 263,543 )
        --找药品的行数
        local counts = 0
        --找到蓝药
        local lanyaoshu = 0
        local hh = 0
        local lh = 0
        while hh < 4 do
            --判断是否在背包界面
            if not findPic_boolean("shuaxin.bmp",90, 502,156 , 575,293 ) and 
            not findPic_boolean("guanbixianshi.bmp",90, 390,194 , 635,405 )then
                --关闭背包界面
                findPic("guanbibeibao.bmp",90, 582,1074, 639,1134)
                notifyMessage("不在背包界面退出买药判定")
                logD("不在背包界面退出买药判定")
                mSleep(1500)
                return
            end
            --l相隔12            --h相隔8
            --行方向间隔101      --列方向102
            --起始范围  428,560         结束范围     525,660
            --第一个格子坐标    橙色  0xFFFFB5    紫色为 0xE751E7    蓝色  0xC6DBEF   绿色   0x29D7BD     
            if findOneColor_boolean(0xFFFFB5,85,428-lh*102,560 +hh*101,525-lh*102,660+hh*101) or 
            findOneColor_boolean(0xE751E7,85,428-lh*102,560 +hh*101,525-lh*102,660+hh*101) or 
            findOneColor_boolean(0xC6DBEF,85,428-lh*102,560 +hh*101,525-lh*102,660+hh*101) or 
            findOneColor_boolean(0x29D7BD,85,428-lh*102,560 +hh*101,525-lh*102,660+hh*101) then
                clicktf(x,y)
                --如果有蓝药      
                if findPic_boolean("lanyao1.bmp",90, 440,14  , 513,92  ) or
                findPic_boolean("lanyao2.bmp",90, 440,14  , 513,92  )then
                    --发现蓝药次数
                    lanyaoshu = lanyaoshu +1
                end
                --取消显示
                findPiclp("guanbixianshi.bmp",90, 390,194 , 635,405 )
                --判断计数
                if lanyaoshu >1 then
                    --取消显示
                    findPiclp("guanbixianshi.bmp",90, 390,194 , 635,405 )
                    --关闭背包
                    findPictf("guanbibeibao.bmp",90, 568,1051, 639,1131)
                    notifyMessage("蓝药充足,无需买药")
                    logD("蓝药充足,无需买药")
                    mSleep(1500)
                    return
                end
                --完成阅读
                findPictf("wanchengyuedu.bmp",90,  87,506 , 125,618 )
            else
                --取消显示
                findPiclp("guanbixianshi.bmp",90, 390,194 , 635,405 )
            end
            hh = hh + 1
            if hh>=4 then
                hh = 0
                lh = lh+1
            end
            if lh>=4 then
                lh = 0
                hh = 0
                --滑动屏幕
                myMove_RL( 159,736 ,1200,778,20)
                counts = counts +1
            end
            if counts >=4 then
                --取消显示
                findPictf("guanbixianshi.bmp",90, 390,194 , 635,405 )
                --关闭背包
                findPic("guanbibeibao.bmp",90, 568,1051, 639,1131)
                --开始买药
                notifyMessage("药品不足,开始买药")
                logD("药品不足,开始买药")
                mSleep(2000)
                -------------------------------------------------------------开始买药------------------
                --进行买药
                dayaohulu()
                return
            end
        end
    end
end
--去买药
function dayaohulu()
    --关闭
    guanbi()
    --退战
    tuizhan()
    --后台到前台
    qiantai()
    notifyMessage("买药",2000)
    logD("买药")
    mSleep(3000)
    --发现进入游戏   退出
    x,y = findMultiColorInRegionFuzzy(color_juesejinru,90,   2,888 , 113,1130)
    if x ~= -1 and y ~= -1 then
        return
    end
    --关闭npc对话
    findPictf("guanbiNPC.bmp",90, 575,277 , 638,327 )
    --关闭对话
    for i = 1,10 do
        findPicDialog("duihua.bmp",90,   1,1091,  33,1121)
    end
    --跳过动画
    findPicDialog("tiaoguo.bmp",90, 579,0   , 638,108 )
    --左
    touchDown(0,  99,79  )
    mSleep(500)
    touchUp(0)
    --点开地图
    click( 585,1065)
    --点回城
    findPic("huicheng.bmp",90,   3,956 , 100,1133)
    --确定回城
    findPic("quedinghuicheng.bmp",90, 193,413 , 262,534 )
    --10秒
    mSleep(10000)
    --发现进入游戏   退出
    x,y = findMultiColorInRegionFuzzy(color_juesejinru,90,   2,888 , 113,1130)
    if x ~= -1 and y ~= -1 then
        return
    end
    --点开地图
    click( 585,1065)
    --点击药NPC寻路
    findMuColor(color_ditushangren,90, 243,427 , 430,722 )
    mSleep(3000)
    --关闭地图
    findPic("guanbiditu.bmp",90, 571,1063, 638,1132)
    --发现进入游戏   退出
    x,y = findMultiColorInRegionFuzzy(color_juesejinru,90,   2,888 , 113,1130)
    if x ~= -1 and y ~= -1 then
        return
    end
    --点击药店商人
    findPic("NPC.bmp",85, 324,989 , 393,1060)
    ------------------------------------------------------------------------------------------------------------------------
    x,y = findPic("yaopinganniu.bmp",90, 271,8   , 376,327 )
    if x~=-1 and y~=-1 then
        --买红
        findPic("hong.bmp",90, 242,133 , 592,361 )
        --发现进入游戏   退出
        x,y = findMultiColorInRegionFuzzy(color_juesejinru,90,   2,888 , 113,1130)
        if x ~= -1 and y ~= -1 then
            return
        end
        --点输入数量
        findMuColor(color_yaoshurukuang,90, 350,312 , 396,482 )
        inputText(999)
        --点击done
        findPic("done.bmp",90, 315,1   , 535,1003)
        --多次买
        for i = 1,1 do
            --买
            --click( 290,421 )
            findPic("goumaih.bmp",90, 140,337 , 549,524 )
            --购买确定
            --click( 229,478 )
            findPic("maiquedingh.bmp",90, 187,404 , 266,544 )
        end
        --发现进入游戏   退出
        x,y = findMultiColorInRegionFuzzy(color_juesejinru,90,   2,888 , 113,1130)
        if x ~= -1 and y ~= -1 then
            return
        end
        --买蓝
        findPic("lan.bmp",90, 500,172 , 566,233 )
        --点输入数量
        findMuColor(color_yaoshurukuang,90, 447,372 , 488,414 )
        inputText(999)
        --点击done
        findPic("done.bmp",90, 315,1   , 535,1003)
        --多次买
        for i = 1,6 do
            --买
            findPic("goumail.bmp",90, 351,359 , 420,481 )
            --购买确定
            findPic("maiquedingl.bmp",90, 193,413 , 267,543 )
        end
    end
    --关闭药店
    findPic("guanbiyaodian.bmp",90, 568,1058, 639,1134)
    --关闭药店
    findPic("guanbiyaodian.bmp",90, 568,1058, 639,1134)
end
--退出战斗
function tuizhan()
    if findPic_boolean("beibao.bmp",90,   2,534 ,  57,598 ) then
        notifyMessage("退战",2000)
        logD("退战")
        mSleep(3000)
        --左
        touchDown(0,  99,79  )
        mSleep(10000)
        touchUp(0)
        --等待5秒
        mSleep(5000)
        --右
        touchDown(0, 101,142 )
        mSleep(10000)
        touchUp(0)
        --等待5秒
        mSleep(5000)
        --上
        touchDown(0, 130,109 )
        mSleep(10000)
        touchUp(0)
        --等待5秒
        mSleep(5000)
        --下
        touchDown(0,  66,112 )
        mSleep(10000)
        touchUp(0)
        --等待5秒
        mSleep(5000)
    end
end
--天降神兵
function shenbing()
    if findPic_boolean("beibao.bmp",90,   2,534 ,  57,598 ) then
        --后台到前台
        qiantai()
        mSleep(2000)
        notifyMessage("开始神兵抽取",2000)
        logD("抽取天降神兵")
        mSleep(3000)
        --点击奇遇
        findPic("qiyu.bmp",90, 452,878 , 554,985 )
        --点击天降神兵
        findPic("tianjiangshenbing.bmp",90, 106,229 , 321,430 )
        --抽取一次45级
        findMuColor(color_45ji,90, 149,179 , 217,301 )
        --发现进入游戏   退出
        x,y = findMultiColorInRegionFuzzy(color_juesejinru,90,   2,888 , 113,1130)
        if x ~= -1 and y ~= -1 then
            return
        end
        --关闭界面
        click( 401,1032)
        --点击60级装备
        findPic("60ji.bmp",90, 190,448 , 489,683 )
        --抽取一次60级装备
        findMuColor(color_60ji,90, 146,446 , 213,572 )
        --发现进入游戏   退出
        x,y = findMultiColorInRegionFuzzy(color_juesejinru,90,   2,888 , 113,1130)
        if x ~= -1 and y ~= -1 then
            return
        end
        --关闭界面
        click( 401,1032)
        --点击70级装备
        findPic("70ji.bmp",90, 257,748 , 471,932 )
        --抽取一次70级装备
        findMuColor(color_70ji,90, 151,717 , 212,838 )
        --关闭界面
        click( 401,1032)
        --关闭天降神兵界面
        findPic("guanbishenbing.bmp",90, 563,1058, 639,1132)
        notifyMessage("神兵抽取结束",2000)
        mSleep(3000)
    end
end
--清理邮件
function clearEmail()
    if findPic_boolean("beibao.bmp",90,   2,534 ,  57,598 ) then
        notifyMessage("提取邮件")
        logD("清理邮件")
        mSleep(2000)
        --点击邮件
        findPic("youjian.bmp",90, 464,80  , 526,142 )
        --点设置   没发现邮件的话
        findMuColor(color_shezhi,90, 458,2, 533,77)
        --点击邮件
        findPic("youjian.bmp",90, 464,80  , 526,142 )
        if findMuColor_boolean(color_sendEmail,90, 536,184 , 571,266 ) then
            time1 = os.time()
            while true do
                --空邮件与非空邮件
                findPic("laijian.bmp",90, 426,187 , 497,265 )
                findPic("laijian1.bmp",90,426,187 , 497,265 )
                --提取附件
                if findPic_boolean("tiqufujian.bmp",90,  20,677 ,  73,809 ) then
                    click(x,y)
                    --删除邮件
                    findPic("Emailshanchu.bmp",90,  19,170 ,  77,290 )
                end
                --使用获得的物品
                for i = 1,4 do
                    --使用获得的物品
                    findMuColor(color_huode,90, 269,115 , 305,243 )
                    --取消传承
                    if findPic_boolean("chuanchengjiemian.bmp",90, 407,535 , 444,602 )then
                        --取消传承
                        findPictf("quxiaochuancheng.bmp",90, 196,603 , 259,720 )
                    end

                end
                --提取附件
                findPic("tiqufujian.bmp",90,  20,677 ,  73,809 )
                --删除邮件
                findPic("Emailshanchu.bmp",90,  19,170 ,  77,290 )
                --确定删除
                findPic("quedingshanchu.bmp",90, 207,439 , 245,519 )
                --超时10分钟退出
                time2 = os.time()
                if time2 - time1 >600 then
                    --重置时间
                    time1 = os.time()
                    notifyMessage("处理邮件10分钟超时")
                    mSleep(1500)
                    logD("邮件提取完毕")
                    mSleep(2000)
                    --关闭界面
                    findPic("guanbiyoujian.bmp",90, 575,1068, 639,1134)
                    return
                end
                --邮件删除完毕退出
                if not findPic_boolean("laijian.bmp",90, 426,187 , 497,265 ) and
                not findPic_boolean("laijian1.bmp",90,426,187 , 497,265 ) then
                    --关闭界面
                    findPic("guanbiyoujian.bmp",90, 575,1068, 639,1134)
                    --邮件提取完毕
                    notifyMessage("邮件提取完毕")
                    mSleep(1500)
                    logD("邮件提取完毕")
                    mSleep(2000)
                    return
                end
            end
        end
        --关闭界面
        findPic("guanbiyoujian.bmp",90, 575,1068, 639,1134)
    end
end
--单人罗盘
function danrenluopan()
    --点击挂机
    findMuColortf(color_guaji,90, 308,1040, 390,1131)
    --关闭
    guanbi()
    mSleep(2000)
    --获取焦点
    qiantai()
    --退队伍
    tuiDui()
    --开始幻境罗盘
    mSleep(3000)
    local time1 = os.time()
    while true do
        --点击日常
        findPic("richang.bmp",90, 460,938 , 560,1043)
        --向右滑动
        findPic("xiangyou.bmp",85, 294,1073, 348,1114)
        --clicktf( 321,1100)
        --向右滑动
        findPic("xiangyou.bmp",85, 294,1073, 348,1114)
        --点击幻境罗盘
        findPic("hjlp.bmp",90, 192,554 , 329,718 )
        --进行简单罗盘
        findPic("jiandanluopan.bmp",90,  18,392 ,  89,482 )
        --进入罗盘
        if findPic_boolean("jinrufuben.bmp",90,   7,745 , 110,918 ) then
            click(x,y)
            notifyMessage("单人简单罗盘")
            logD("单人简单罗盘")
            mSleep(1500)
            return
        end
        local time2 = os.time()
        if time2 - time1 > 60 then
            time1 = os.time()
            notifyMessage("简单罗盘副本超时")
            mSleep(1500)
            logD("简单罗盘副本超时")
            appKill("com.idreamsky.cqb.pp")
            mSleep(4000)
            appRun("com.idreamsky.cqb.pp")
            mSleep(5000)
        end
    end
end
----幻境罗盘打困难级别
function luopan()
    --点击挂机
    findMuColortf(color_guaji,90, 308,1040, 390,1131)
    --关闭
    guanbi()
    mSleep(2000)
    --获取焦点
    qiantai()
    --退队伍
    tuiDui()
    --开始幻境罗盘
    mSleep(3000)
    --点击日常
    findPic("richang.bmp",90, 460,938 , 560,1043)
    --向右滑动
    findPic("xiangyou.bmp",85, 294,1073, 348,1114)
    --clicktf( 321,1100)
    --向右滑动
    findPic("xiangyou.bmp",85, 294,1073, 348,1114)
    --点击幻境罗盘
    findPic("hjlp.bmp",90, 192,554 , 329,718 )
    --点击困难级别
    findPic("kunnan.bmp",90,  62,585 , 180,714 )
    --点击自动匹配
    findPic("zidongpipei.bmp",90,  24,575 ,  90,714 )
    --关闭副本进入界面
    findPic("guanbifuben.bmp",90, 578,1073, 638,1131)
    --点击挂机
    findMuColortf(color_guaji,90, 308,1040, 390,1131)
    --自动匹配次数计数
    local pipeishu = 0
    --罗盘完毕次数
    local wanbishu = 0
    --第一点时间
    time1 = os.time()
    while true do
        --没过2分钟进行一次副本匹配
        local time3 = os.time()
        if time3 % 120 < 10 and not findPic_boolean("tuichufb.bmp",90, 509,1035, 567,1094) 
        and findPicLostColor_boolean("duiwu.bmp",85, 401,14  , 442,65,  0xFF00FF)then
            --退队伍
            tuiDui()
            --点击日常
            findPic("richang.bmp",90, 460,938 , 560,1043)
            --向右滑动
            findPic("xiangyou.bmp",85, 294,1073, 348,1114)
            --clicktf( 321,1100)
            --向右滑动
            findPic("xiangyou.bmp",85, 294,1073, 348,1114)
            --clicktf( 321,1100)
            --判断次数用完
            if findPicLostColor_boolean("luopancishu.bmp",90, 204,616 , 225,635 ,0xFF00FF) then
                notifyMessage("罗盘次数已用2次")
                logD("罗盘次数已用2次")
                mSleep(1500)
                --关闭副本进入界面
                findPic("guanbifuben.bmp",90, 578,1073, 638,1131)
                return
            end
            --点击幻境罗盘
            findPic("hjlp.bmp",90, 192,554 , 329,718 )
            --点击困难级别
            findPic("kunnan.bmp",90,  62,585 , 180,714 )
            --点击自动匹配
            if findPic_boolean("zidongpipei.bmp",90,  24,575 ,  90,714 )then
                clickTime(x,y)
                if pipeishu >=10 then
                    --进入副本
                    findPic("jinrufuben.bmp",90,   7,745 , 110,918 )
                    pipeishu = 0
                end
                if findPic_boolean("zidongpipei.bmp",90,  24,575 ,  90,714 ) then
                    --关闭副本进入界面
                    findPic("guanbifuben.bmp",90, 578,1073, 638,1131)
                    if wanbishu >=5 then
                        notifyMessage("幻境罗盘没次数")
                        mSleep(1500)
                        logD("幻境罗盘没次数")
                        wanbishu = 0
                        return
                    end
                    wanbishu = wanbishu +1
                end
                pipeishu = pipeishu +1
            end
            --关闭副本进入界面
            findPic("guanbifuben.bmp",90, 578,1073, 638,1131)
        end 

        --点击挂机
        findMuColortf(color_guaji,90, 308,1040, 390,1131)
        --确认进入副本
        if findPic_boolean("dengdaiqueren.bmp",90, 408,517 , 450,620 )then
            --确认副本进入界面
            findPictf("querenjinru.bmp",90, 202,423 , 252,529 )
        end
        --罗盘中确认使用经验斗气物品
        if findPic_boolean("shiyongtishi.bmp",90, 354,511 , 397,642 )then
            --使用经验*3
            click( 281,434 )
            --使用经验*2
            click( 281,524 )
            --使用斗气*3
            click( 279,609 )
            --使用斗气*2
            click( 282,698 )
            --点击确定使用
            findPictf("quedingshiyong.bmp",90, 201,422 , 253,533 )
        end
        --取消提示
        --findPictf("quxiaots.bmp",90, 190,593 , 263,720 )
        --转动转盘
        findPicTime("zhuandong.bmp",90,  44,477 , 115,649 )
        --异常之类窗口
        exception()
        --副本超时 10分钟
        local time2 = os.time()
        if time2-time1 >600  then
            time1 = os.time()
            notifyMessage("副本超时")
            mSleep(1500)
            logD("副本超时")
            appKill("com.idreamsky.cqb.pp")
            mSleep(4000)
            appRun("com.idreamsky.cqb.pp")
            mSleep(5000)
        end
    end
end
--领奖与锻炉.招财
function qiyu()
    --关闭
    guanbi()
    exception()
    --后台到前台
    qiantai()
    notifyMessage("奇遇",2000)
    logD("开始奇遇")
    mSleep(3000)
    --点击奇遇
    if findPic_boolean("qiyu.bmp",90, 452,878 , 554,985 ) then
        click(x,y)
        --招财
        findPic("zhaocai.bmp",90, 311,261 , 490,451 )
        --有没有使用次数
        if findPicLostColor_boolean("shendengmianfei.bmp",90,  26,436 ,  50,483 ,0xFF00FF) then
            --摩擦神灯
            findPicTime("shendeng.bmp",90, 185,522 , 269,629 )
        end
        --取消使用金砖
        findPic("quxiaoJZ.bmp",90, 187,584 , 273,730 )
        --关闭招财
        findPic("guanbizhaocai.bmp",90, 551,1045, 638,1132)
        --领奖
        lingjiang()
        --天降神兵
        --shenbing()
        --锻炉
        duanlu()
        --使用纳戒
        najie()
        exception()
        --关闭弹窗
        guanbi()
        --清理背包
        --clearBag()
    end
end
--纳戒宝库
function najie()
    --关闭
    guanbi()
    --后台到前台
    qiantai()
    notifyMessage("开始纳戒",2000)
    logD("开始纳戒")
    mSleep(3000)
    --点击日常
    findPic("richang.bmp",90, 460,938 , 560,1043)
    --纳戒宝库
    if findPic_boolean("najiebaoku.bmp",90, 348,588 , 391,688 ) then
        click(x,y)
        --抽奖
        findPic("choujiang.bmp",90,  38,504 ,  98,624 )
        --抽奖
        findPic("choujiang.bmp",90,  38,504 ,  98,624 )
        mSleep(10000)
        --获得新物品
        findMuColor(color_huode,90, 269,115 , 305,243 )
        --获得新物品
        findMuColor(color_huode,90, 269,115 , 305,243 )
        --取消传承
        if findPic_boolean("chuanchengjiemian.bmp",90, 407,535 , 444,602 )then
            --取消传承
            findPictf("quxiaochuancheng.bmp",90, 196,603 , 259,720 )
        end
        clicktf(  18,879 )
    end
    --关闭纳戒界面
    findPic("guanbinajie.bmp",90, 579,1074, 639,1134)
    mSleep(5000)
end

--锻炉
function duanlu()
    --后台到前台
    qiantai()
    --开始锻炉
    notifyMessage("锻炉",2000)
    logD("锻炉")
    mSleep(3000)
    --打开背包
    findPic("beibao.bmp",90,   4,531 ,  57,594 )
    --click(  31,568 )
    --点击锻炉
    findPicTime("duanlu.bmp",90,   2,547 ,  88,700 )
    mSleep(1500)
    --一件放入，一件合成
    for i = 1,6 do
        --放入
        findPictf("fangru.bmp",90,   7,262 ,  99,430 )
        --合成
        findPictf("hecheng.bmp",90,   7,270 ,  99,437 )
    end
    --随身商店
    findPic("suishenshangdian.bmp",90,   3,822 ,  94,983 )
    --点击出售白装提示
    findPic("baizhuangqueding.bmp",90, 193,407 , 263,543 )
    --关闭背包
    findPic("guanbiduanlu.bmp",90, 568,1051, 639,1131)
    --
    mSleep(5000)
    --关闭背包
    findPic("guanbiduanlu.bmp",90, 568,1051, 639,1131)

end
--喊话并加好友
function hanhua()
    --后台到前台
    qiantai()
    notifyMessage("开始喊话",2000)
    logD("开始喊话")
    mSleep(3000)
    --点击打开喊话窗口
    logD("打开喊话窗口")
    --发现进入游戏   退出
    x,y = findMultiColorInRegionFuzzy(color_juesejinru,90,2,888,113,1130)
    if x ~= -1 and y ~= -1 then
        return
    end

    --背包图标
    if findPic_boolean("beibao.bmp",90,   2,534 ,  57,598 ) then
        --点击世界窗口 
        click(x+60,y-100)
        --点击切换到键盘
        findPic("jianpan.bmp",90,  31,567 , 210,705 )
        --点击输入框
        findPic("shurukuang.bmp",90,  28,749 ,  92,937 )
        --click(  61,756 )
        --输入内容
        logD("喊话内容：")
        inputText("苍穹变第一家族,裕仁家族")
        findPic("done.bmp",90, 239,822 , 524,1002)
        --点击发送
        logD("发送")
        findPic("fasong.bmp",90,  25,862 , 249,981 )
        findPic("guanbihanhua.bmp",90, 524,885 , 628,995 )
        --click( 590,956 )
        logD("关闭喊话窗口")
        mSleep(3000)
    end
end
--处理好友请求
function fqq()
    notifyMessage("开始处理好友请求")
    mSleep(1500)
    while true do
        --点开好友请求
        findPic("haoyouqingqiu.bmp",90, 191,382 , 260,523 )
        if not findPic_boolean("quanbutianjia.bmp",90, 112,741 , 162,858 ) then
            notifyMessage("好友请求已处理完毕")
            mSleep(1500)
            return
        end
        --是不是裕仁结尾
        if findMuColor_boolean(color_yurenqingqiu,90, 391,330 , 454,561 ) then
            --添加为好友
            findPic("tianjia.bmp",90, 390,637 , 453,744 )
        else
            --忽略请求
            findPic("hulve.bmp",90, 397,739 , 452,840 )
        end
    end   
end

--退出队伍并关闭自动同意邀请
function tuiDui()
    notifyMessage("退出队伍")
    logD("退出队伍")
    mSleep(2000)
    --退出队伍
    findMuColor(color_tuichuduiwu,85, 290,19  , 332,58  )
    --点击队伍图标
    findPicLostColor("duiwu.bmp",85, 401,14  , 442,65,  0xFF00FF)
    --退出队伍
    findMuColor(color_tuichuduiwu,85, 290,19  , 332,58  )
    --关闭队伍界面
    findPic("guanbiduiwu.bmp",90, 578,1067, 638,1134)
--[[
    --关闭自动同意
    --点击队伍图标
    findPic("duiwu.bmp",90, 401,14  , 442,65  )
    --关闭自动同意
    findPic("zidongzudui.bmp",90, 481,929 , 525,971 )
    --关闭队伍界面
    findPic("guanbiduiwu.bmp",90, 578,1067, 638,1134)
--]]
end
--悬赏任务
function xuanshang()
    --点击挂机
    findMuColortf(color_guaji,90, 308,1040, 390,1131)
    --关闭
    guanbi()
    mSleep(2000)
    notifyMessage("开始悬赏")
    mSleep(1500)
    --点击纳戒
    findPic("najie.bmp",90, 192,20  , 286,127 )
    --点击日常
    findPic("richang.bmp",90, 464,876 , 553,1038)
    --点击悬赏任务
    findPic("xuanshang.bmp",90, 298,471 , 401,584 )
    --点击自动购买
    findPic("zidonggoumai.bmp",90,  21,554 ,  71,607 )
    --点击一键升星
    findPicLostColor("yijianshengxing.bmp",90,  24,859 ,  67,958,0xFF00FF )
    findPicLostColor("yijianshengxing.bmp",90,  24,859 ,  67,958,0xFF00FF )
    --取消悬赏晶钻
    findPic("qxXsJz.bmp",90, 208,626 , 245,695 )
    --点击接受任务
    findPic("xuanshangjieshou.bmp",90,  24,220 ,  99,371 )
    --前往
    findPic("qianwang.bmp",90,  31,246 ,  89,358 )
    if findPic_boolean("xuanshangjieshou.bmp",90,  24,220 ,  99,371 ) then
        --关闭悬赏界面
        findPictf("guanbixuanshang.bmp",90, 578,1066, 638,1134)
        notifyMessage("悬赏没次数")
        logD("悬赏没次数")
        return
    end
    --悬赏接受存在接受次数
    local counts = 0
    --第一点时间
    time1 = os.time()
    while true do
        --断网异常判断
        exception()
        --超时15判断
        time2 = os.time()
        if time2 - time1 >900 then
            --重置时间
            time1 = os.time()
            notifyMessage("悬赏任务8分钟超时")
            logD("悬赏任务8分钟超时")
            --关闭游戏在开启游戏
            appKill("com.idreamsky.cqb.pp")
            mSleep(4000)
            appRun("com.idreamsky.cqb.pp")
            mSleep(5000)
        end
        --每过1分钟接受悬赏,并判断悬赏任务是否已完成
        local time4 = os.time()
        if time4%60 <10 then
            --点击纳戒
            findPic("najie.bmp",90, 192,20  , 286,127 )
            --点击日常
            findPic("richang.bmp",90, 464,876 , 553,1038)
            --点击悬赏任务
            findPic("xuanshang.bmp",90, 298,471 , 401,584 )
            --点击自动购买
            findPic("zidonggoumai.bmp",90,  21,554 ,  71,607 )
            --点击一键升星
            findPicLostColor("yijianshengxing.bmp",90,  24,859 ,  67,958,0xFF00FF )
            findPicLostColor("yijianshengxing.bmp",90,  24,859 ,  67,958,0xFF00FF )
            --取消悬赏晶钻
            findPic("qxXsJz.bmp",90, 208,626 , 245,695 )
            --点击接受任务
            findPic("xuanshangjieshou.bmp",90,  24,220 ,  99,371 )
            --前往
            findPic("qianwang.bmp",90,  31,246 ,  89,358 )
            if findPic_boolean("xuanshangjieshou.bmp",90,  24,220 ,  99,371 ) then
                --关闭悬赏界面
                findPictf("guanbixuanshang.bmp",90, 578,1066, 638,1134)
                counts = counts +1
                if counts >=3 then
                    notifyMessage("悬赏次数已用完")
                    logD("悬赏次数已用完")
                    return
                end
            end
        end
    end
end

--斗气修炼
function douqi()
    --点击挂机
    findMuColortf(color_guaji,90, 308,1040, 390,1131)
    --关闭
    guanbi()
    mSleep(2000)
    --斗气已满
    if findMuColor_boolean(color_mandouqi,90,6,678 ,30,754 ) then
        notifyMessage("开始斗气修炼")
        mSleep(1500)
        click(x,y)
        mSleep(5000)
        time1 = os.time()
        while true do
            --超时1分钟
            local time2 = os.time()
            if time2 - time1 >60 then
                notifyMessage("斗气修炼超时")
                logD("斗气修炼超时")
                mSleep(1500)
                --关闭斗气界面
                findPictf("guanbidouqi.bmp",90, 578,1073, 639,1133)
                return
            end
            --异常之类判断
            exception()
            --斗魂修炼
            findMuColor(color_douhunxiulian,90,   5,888 ,  91,1096)
            mSleep(5000)
            --突破
            if findPic_boolean("tupo.bmp",90,  10,1012,  85,1121)then
                clicktf(x,y)
                if findPic_boolean("tupo.bmp",90,  10,1012,  85,1121)then
                    --关闭斗气界面
                    findPictf("guanbidouqi.bmp",90, 578,1073, 639,1133)
                end
            end
            --点击修炼
            findPicTime("xiulian.bmp",90,  16,1014,  87,1125)
            --跳过动画
            findPicDialog("tiaoguo.bmp",90, 601,65  , 633,99  )
            --斗气不足
            if findPic_boolean("douqibuzu.bmp",90, 219,526 , 252,601 ) then
                click(x,y)
                --关闭斗气界面
                findPictf("guanbidouqi.bmp",90, 578,1073, 639,1133)
                notifyMessage("斗气修炼完毕")
                mSleep(5000)
                return
            end
        end
    end
end

--领奖
function lingjiang()
    mSleep(2000)
    --后台到前台
    --关闭弹窗
    guanbi()
    --获取焦点
    qiantai()
    notifyMessage("开始领奖",2000)
    mSleep(3000)
    --点击界面领奖
    findPic("lingjiang.bmp",90, 541,938 , 630,1035)
    --点击界面领奖2
    findPic("lingjiang_1.bmp",90, 541,944 , 635,1037)
    findPic("lingjiang1.bmp",90, 541,938 , 630,1035)
    --点击在线礼包
    findPic("zaixianlibao.bmp",90, 304,212 , 510,926 )
    --全部领取
    findPic("quanbulingqu.bmp",90,  43,471 , 150,655 )

    --点击界面领奖
    findPic("lingjiang.bmp",90, 541,938 , 630,1035)
    --点击界面领奖2
    findPic("lingjiang_1.bmp",90, 541,944 , 635,1037)
    findPic("lingjiang1.bmp",90, 541,938 , 630,1035)
    --等级礼包红点
    if findPic_boolean("dengjilibao.bmp",90, 390,266 , 471,376 )then
        --打开等级礼包
        clicktf(x,y)
        mSleep(1000)
        for i = 1,3 do
            for j = 1,3 do
                --领取
                findPic("lingqu.bmp",90,  58,772 , 482,939 )
                for i=1,4 do
                    --获得新物品
                    findMuColor(color_huode,90, 269,115 , 305,243 )
                    --取消传承
                    if findPic_boolean("chuanchengjiemian.bmp",90, 407,535 , 444,602 )then
                        --取消传承
                        findPictf("quxiaochuancheng.bmp",90, 196,603 , 259,720 )
                    end
                end
            end
            myMove_RL( 184,538 , 345,535 ,15)
            mSleep(2000)
        end
        --关闭等级礼包界面
        findPic("guanbilibao.bmp",90, 542,906 , 596,963 )
    end

    --点击界面领奖
    findPic("lingjiang.bmp",90, 541,938 , 630,1035)
    --点击界面领奖2
    findPic("lingjiang_1.bmp",90, 541,944 , 635,1037)
    findPic("lingjiang1.bmp",90, 541,938 , 630,1035)
    --7日签到
    findPic("7qiandao.bmp",90, 322,408 , 498,575 )
    --领取
    findPic("lingqu1.bmp",90,  53,658 , 118,797 )
    for i=1,4 do
        --获得新物品
        findMuColor(color_huode,90, 269,115 , 305,243 )
        --取消传承
        if findPic_boolean("chuanchengjiemian.bmp",90, 407,535 , 444,602 )then
            --取消传承
            findPictf("quxiaochuancheng.bmp",90, 196,603 , 259,720 )
        end
    end
    --关闭7日签到界面
    findPic("guanbi7ri.bmp",90, 584,904 , 633,958 )

    --30签到

    --点击界面领奖
    findPic("lingjiang.bmp",90, 541,938 , 630,1035)
    --点击界面领奖2
    findPic("lingjiang_1.bmp",90, 541,944 , 635,1037)
    findPic("lingjiang1.bmp",90, 541,938 , 630,1035)
    --点击30日签到
    findPic("qiandao.bmp",90, 304,212 , 510,926 )
    --点击签到领奖
    findPic("qiandaolingjiang.bmp",90,  42,721 , 129,883 )
    --全部领取
    findPic("quanbulingqu.bmp",90,  43,471 , 150,655 )
    --发现进入游戏   退出
    x,y = findMultiColorInRegionFuzzy(color_juesejinru,90,   2,888 , 113,1130)
    if x ~= -1 and y ~= -1 then
        return
    end
    --退出领奖界面
    findPic("tuichulingjiang.bmp",90, 550,950 , 631,1045)
    --关闭30日签到
    findPic("guanbiqiandao.bmp",90, 557,841 , 612,904 )
    notifyMessage("领奖完毕",2000)
    mSleep(3000)
end
--吃筑基丹
function chi20()
    --打开背包
    if findPic_boolean("beibao.bmp",90,   4,531 ,  57,594 ) then
        click(x,y)
        if findPic_boolean("beibao.bmp",90,   4,531 ,  57,594 ) then
            notifyMessage("未进入背包界面退出")
            mSleep(1500)
            logD("未进入背包界面退出")
            --关闭背包
            findPic("guanbibeibao.bmp",90, 568,1051, 639,1131)
            return
        end
        local hh = 0
        local lh = 0
        --下拉次数
        local counts = 0
        --扩包点击次数
        local kuobaoshu = 0
        mSleep(2000)
        while hh < 4 do
            --取消传承
            findPiclp("quxiaochuancheng.bmp",90, 196,603 , 259,720 )
            --判断是否在背包界面
            if not findPic_boolean("duanlu.bmp",90,   2,547 ,  88,700 ) and
            not findPic_boolean("guanbixianshi.bmp",90, 390,194 , 635,405 ) then
                --取消显示
                findPictf("guanbixianshi.bmp",90, 390,194 , 635,405 )
                --关闭背包界面
                findPic("guanbibeibao.bmp",90, 582,1074, 639,1134)
                notifyMessage("不在背包界面退出")
                logD("不在背包界面退出")
                mSleep(1500)
                return
            end
            --l相隔12            --h相隔8
            --行方向间隔101      --列方向102
            --起始范围  428,560         结束范围     525,660
            --第一个格子坐标    橙色  0xFFFFB5    紫色为 0xE751E7    蓝色  0xC6DBEF   绿色   0x29D7BD     
            if findOneColor_boolean(0xFFFFB5,85,428-lh*102,560 +hh*101,525-lh*102,660+hh*101) or 
            findOneColor_boolean(0xE751E7,85,428-lh*102,560 +hh*101,525-lh*102,660+hh*101) or 
            findOneColor_boolean(0xC6DBEF,85,428-lh*102,560 +hh*101,525-lh*102,660+hh*101) or 
            findOneColor_boolean(0x29D7BD,85,428-lh*102,560 +hh*101,525-lh*102,660+hh*101) then
                clicktf(x,y)
                --筑基丹使用
                if findPic_boolean("zhujidanbb.bmp",90, 440,14  , 513,92  ) then
                    --使用
                    findPictf("shiyong.bmp",90,  90,197 , 128,282 )
                    --最大
                    findPicLostColor("zuida.bmp",90, 254,635 , 289,712,0xFF00FF )
                    --确认使用
                    findPicLostColor("querenshiyong.bmp",90, 164,517 , 198,620 ,0xFF00FF)
                    --取消显示
                    findPictf("guanbixianshi.bmp",90, 390,194 , 635,405 )
                    --确定组队
                    findPictf("chuanchengqueding.bmp",90, 209,435 , 246,517 )
                    logD("筑基丹使用完毕")
                    mSleep(1500)
                elseif findPic_boolean("30jidan.bmp",90, 440,14  , 513,92  ) then
                    --使用
                    findPictf("shiyong.bmp",90,  90,197 , 128,282 )
                    --最大
                    findPicLostColor("zuida.bmp",90, 254,635 , 289,712,0xFF00FF )
                    --确认使用
                    findPicLostColor("querenshiyong.bmp",90, 164,517 , 198,620 ,0xFF00FF)
                    --取消显示
                    findPictf("guanbixianshi.bmp",90, 390,194 , 635,405 )
                    --确定组队
                    findPictf("chuanchengqueding.bmp",90, 209,435 , 246,517 )
                    mSleep(1500)
                else
                    --取消显示
                    findPictf("guanbixianshi.bmp",90, 390,194 , 635,405 )
                end
                --完成阅读
                findPictf("wanchengyuedu.bmp",90,  87,506 , 125,618 )
            else
                --点击格子
                clickDialog(428-lh*102,560 +hh*101,525-lh*102,660+hh*101)
                --开启背包提示
                if findPic_boolean("kaiqibeibao.bmp",90, 409,517 , 447,620 ) then
                    logD("扩包次数甲乙")
                    mSleep(1500)
                    --取消自动购买
                    findPicTime("kuobaogoumai.bmp",90, 297,659 , 348,722 )
                    --点击确定扩包
                    findPic("quedingkuobao.bmp",90, 200,421 , 256,533 )
                    if kuobaoshu >2 then
                        --关闭背包
                        findPic("guanbibeibao.bmp",90, 568,1051, 639,1131)
                        notifyMessage("扩包次数一刀")
                        logD("扩包次数一刀")
                        mSleep(1500)
                        return
                    end
                    kuobaoshu = kuobaoshu +1
                end
            end
            hh = hh + 1
            if hh>=4 then
                hh = 0
                lh = lh+1
            end
            if lh>=4 then
                mSleep(500)
                lh = 0
                hh = 0
                --滑动屏幕
                myMove_RL( 159,736 ,1200,778,20)
                counts = counts +1
            end
        end
    end
end
--识别等级
function shibiedengji()
    --关闭窗口
    guanbi()
    local sw,gw=0,0
    while (true) do
        if findPicLostColor_boolean("duiwu.bmp",85, 401,14  , 442,65,  0xFF00FF) or 
        findPic_boolean("chongzhi.bmp",90, 533,74  , 581,117 ) then
            notifyMessage('识别等级')
            mSleep(1500)
            if findPicLostColor_boolean("9.bmp",90, 543,34  ,560,44,0xFF00FF)== true then
                sw=9
            elseif findPicLostColor_boolean("8.bmp",90,543,34  ,560,44,0xFF00FF)== true then
                sw=8
            elseif findPicLostColor_boolean("7.bmp",90,543,34  ,560,44,0xFF00FF)== true then
                sw=7
            elseif findPicLostColor_boolean("6.bmp",90,543,34  ,560,44,0xFF00FF)== true then
                sw=6
            elseif findPicLostColor_boolean("5.bmp",90,543,34  ,560,44,0xFF00FF)== true then
                sw=5
            elseif findPicLostColor_boolean("4.bmp",90,543,34  ,560,44,0xFF00FF)== true then
                sw=4
            elseif findPicLostColor_boolean("3.bmp",90,543,34  ,560,44,0xFF00FF)== true then
                sw=3
            elseif findPicLostColor_boolean("2.bmp",90,543,34  ,560,44,0xFF00FF)== true then
                sw=2
            elseif findPicLostColor_boolean("1.bmp",90,543,34  ,560,44,0xFF00FF)== true then
                sw=1
            end
            if findPicLostColor_boolean("9.bmp",90, 543,43  ,560,53,0xFF00FF)== true then
                gw=9
            elseif findPicLostColor_boolean("0.bmp",90, 543,43  ,560,53,0xFF00FF)== true then
                gw=0
            elseif findPicLostColor_boolean("8.bmp",90, 543,43  ,560,53,0xFF00FF)== true then
                gw=8
            elseif findPicLostColor_boolean("7.bmp",90, 543,43  ,560,53,0xFF00FF)== true then
                gw=7
            elseif findPicLostColor_boolean("6.bmp",90, 543,43  ,560,53,0xFF00FF)== true then
                gw=6
            elseif findPicLostColor_boolean("5.bmp",90, 543,43  ,560,53,0xFF00FF)== true then
                gw=5
            elseif findPicLostColor_boolean("4.bmp",90, 543,43  ,560,53,0xFF00FF)== true then
                gw=4
            elseif findPicLostColor_boolean("3.bmp",90, 543,43  ,560,53,0xFF00FF)== true then
                gw=3
            elseif findPicLostColor_boolean("2.bmp",90, 543,43  ,560,53,0xFF00FF)== true then
                gw=2
            elseif findPicLostColor_boolean("1.bmp",90, 543,43  ,560,53,0xFF00FF)== true then
                gw=1
            end
            --notifyMessage(sw*10+gw)
            logD(sw*10+gw)
            mSleep(1500)
            return(sw*10+gw)
        else
            notifyMessage("不在主界面退出")
            logD("不在主界面退出")
            mSleep(1500)
            return 0 
        end
    end 
end 
--主线任务
function zhuxian()
    notifyMessage("开始主线")
    logD("开始主线")
    mSleep(2000)
    --变强次数
    local counts = 0
    --练级主线
    time1 = os.time()
    while true do
        --罗盘中确认使用经验斗气物品
        if findPic_boolean("shiyongtishi.bmp",90, 354,511 , 397,642 )then
            --使用经验*3
            click( 281,434 )
            --使用经验*2
            click( 281,524 )
            --使用斗气*3
            click( 279,609 )
            --使用斗气*2
            click( 282,698 )
            --点击确定使用
            findPictf("quedingshiyong.bmp",90, 201,422 , 253,533 )
        end
        findPictf("zhujidan.bmp",90, 234,39  , 303,106 )
        --提交任务
        findPicTime("tijiaorenwu.bmp",90,28,8, 126,323 )
        --接受任务
        findPicTime("jieshourenwu.bmp",90,  34,9   , 127,325 )
        if counts>=5 then
            logD("主线任务已做完")
            notifyMessage("主线任务已做完")
            mSleep(2000)
            findPictf("guanbibianqiang.bmp",90, 550,903 , 610,962 )
            return
        end
        --超时10分钟
        local time2 = os.time()
        if time2 - time1 >600 then
            time1 = os.time()
            logD("主线超时重启")
            --重启游戏
            notifyMessage("主线超时重启游戏")
            mSleep(2000)
            --退出副本
            findPictf("tuichufuben.bmp",85, 513,1038, 565,1090)
            findMuColortf(color_tuichufuben,90, 509,1035, 567,1094)
            --退出副本
            findMuColortf(color_tuichufuben,90, 509,1035, 567,1094)
            --退出副本
            findPictf("tuichufb.bmp",90, 509,1035, 567,1094)
            --确定退出
            findPictf("quedingtuichu.bmp",90, 207,434 , 246,521 )
            --确定退出
            findPictf("quedingtuichu.bmp",90, 207,434 , 246,521 )
            --确定退出
            findPictf("quedingtuichu.bmp",90, 207,434 , 246,521 )
            mSleep(15000)
            --关闭游戏在开启游戏
            appKill("com.idreamsky.cqb.pp")
            mSleep(4000)
            appRun("com.idreamsky.cqb.pp")
            mSleep(5000)
        end
        --奇遇  40分钟
        local timebb = os.time()
        if timebb%2400<30 then
            logD("主线奇遇")
            --重启游戏
            notifyMessage("主线奇遇")
            mSleep(1500)
            --准备阶段
            zhunbei()
            mSleep(1000)
            --奇遇,领奖,神兵,锻炉,纳戒,清理背包
            qiyu()
            mSleep(5000)
        end
        --设置红蓝条
        honglan()
        --释放技能
        if findMuColor_boolean(color_jineng,90, 421,38  , 543,149 ) then
            --释放技能
            clicktf(89,1052)
        end
        
        --回城复活
        findPiclp("huichengfuhuo.bmp",90, 196,436 , 251,551 )
        --点醒纳戒
        if findPic_boolean("dianxing.bmp",90, 500,823 , 547,894 ) or 
        findPic_boolean("dianxing1.bmp",90, 500,823 , 547,894 ) then
            notifyMessage("点醒1")
            logD("点醒1")
            clicklp(x,y)
        end
        --开启纳戒小人提示
        if findPicLostColor_boolean("kaiqinajietishi.bmp",90, 200,332 , 246,443 ,0xFF00FF)then
            notifyMessage("开启纳戒小人提示")
            logD("开启纳戒小人提示")
            clicklp( 153,73  )
        end
        --点醒纳戒dianxing1
        if findPicLostColor_boolean("dianxingnajie.bmp",90, 474,832 , 508,886 ,0xFF00FF)then
            clicklp(x+30,y)
            notifyMessage("点醒纳戒")
            logD("点醒纳戒")
        end
        --关闭配件
        findPiclp("guanbipeijian.bmp",90, 227,509 , 291,628 )
        --跳过动画
        findPiclp("tiaoguo.bmp",90, 601,65  , 633,99  )
        --领取红包
        findPiclp("hongbao.bmp",90, 477,749 , 526,798 )
        --发现退出副本,说明在副本里面,点击挂机
        if findPic_boolean("tuichufb.bmp",90, 509,1035, 567,1094)then
            --点击挂机
            findMuColorlp(color_guaji,90, 308,1040, 390,1131)
        end
        if findPic_boolean("tuichufuben.bmp",85, 513,1038, 565,1090)then
            --点击挂机
            findMuColorlp(color_guaji,90, 308,1040, 390,1131)
        end
        --退回
        --findPictf("tuihui.bmp",90, 586,1, 638,56)
        --离开副本
        if findPicLostColor_boolean("likaifuben.bmp",90,  18,957 ,  70,1098,0xFF00FF) then
            notifyMessage("离开副本")
            logD("离开副本")
            mSleep(8000)
            clicklp(x,y)
        end
        --转动转盘
        findPicTime("zhuandong.bmp",90,  44,477 , 115,649 )
        --角色进入
        findMuColorlp(color_juesejinru,90,   2,888 , 113,1130)
        --取消传承
        if findPic_boolean("chuanchengjiemian.bmp",90, 407,535 , 444,602 )then
            --取消传承
            findPiclp("quxiaochuancheng.bmp",90, 196,603 , 259,720 )
        end
        --获得新物品
        findMuColorlp(color_huode,90, 269,115 , 305,243 )
        --关闭离线挂机界面
        findPiclp("guanbiguaji.bmp",90, 427,755 , 492,834 )
        --关闭对话
        for i = 1,10 do
            findPiclp("duihua.bmp",90,   1,1091,  33,1121)
        end
        --跳过动画
        if findPic_boolean("tiaoguo.bmp",90, 579,0   , 638,108 ) then
            notifyMessage("跳过动画")
            logD("跳过动画")
            mSleep(2000)
            clicklp(x,y)
            --关闭界面
            findPictf("guanbijuese.bmp",90, 577,1072, 639,1134)
            for i =1,6 do
                mSleep(500)
                --界面回退
                findPiclp("huitui.bmp",90, 586,2, 637,59  )
            end
        end
        --关闭左边NPC对话
        if not findPicTime("tijiaorenwu.bmp",90,28,8, 126,323 )and
        not findPicTime("jieshourenwu.bmp",90,  34,9   , 127,325 )then
            findPiclp("guanbicebianNPC.bmp",90, 585,281 , 638,333 )
        end
        --提交任务
        findPicTime("tijiaorenwu.bmp",90,28,8, 126,323 )
        --接受任务
        findPicTime("jieshourenwu.bmp",90,  34,9   , 127,325 )
        --提交任务
        findPicTime("tijiaorenwu.bmp",90,28,8, 126,323 )
        --立即装备
        findMuColorlp(color_liji,90, 214,252 , 244,354 )
        --关闭斗气界面
        --findPic("guanbidouqi.bmp",90, 578,1073, 639,1133)
        --获得新物品
        findMuColorlp(color_huode,90, 269,115 , 305,243 )
        --间隔31秒
        local rwTime = os.time()
        if rwTime%20<=2 then
            --点开任务眼
            diankairenwu()
        end
        --点击主线任务自动寻路
        --local timezx = os.time()
        --if timezx%4<2 then
        --点击主线任务自动寻路
        findMuColorlp(color_zhuxian,90, 342,74, 373,112 )
        --end

        --人物点击
        if findMuColor_boolean(color_juese,90, 586,212 , 623,359 ) then
            --点击角色
            clicklp( 602,44  )
        end
        --提示修炼斗魂
        if findMuColor_boolean(color_douhun,90, 511,325 , 541,385 ) then
            --点击斗魂
            clicklp( 486,85  )
        end
        --提示斗魂修炼
        if findMuColor_boolean(color_xiulian,90, 140,557 , 171,666 ) then
            --点击斗魂修炼
            clicklp(  53,969 )
            while true do
                --超时1分钟
                local time2 = os.time()
                if time2 - time1 >60 then
                    time1 = os.time()
                    notifyMessage("主线斗气修炼超时")
                    logD("主线斗气修炼超时")
                    mSleep(1500)
                    --关闭斗气界面
                    findPiclp("guanbidouqi.bmp",90, 578,1073, 639,1133)
                    break
                end
                --异常之类判断
                exception()
                --斗魂修炼
                findMuColorlp(color_douhunxiulian,90,   5,888 ,  91,1096)
                --突破
                findPiclp("tupo.bmp",90,  10,1012,  85,1121)
                --点击修炼
                findPicTime("xiulian.bmp",90,  16,1014,  87,1125)
                --跳过动画
                findPiclp("tiaoguo.bmp",90, 601,65  , 633,99  )
                --斗气不足
                if findPic_boolean("douqibuzu.bmp",90, 219,526 , 252,601 ) then
                    clicktf(x,y)
                    --关闭斗气界面
                    findPiclp("guanbidouqi.bmp",90, 578,1073, 639,1133)
                    notifyMessage("主线斗气修炼完毕")
                    mSleep(5000)
                    break
                end
            end
        end
        --斗魂修炼
        findMuColorlp(color_douhunxiulian,90,   5,888 ,  91,1096)
        --点击修炼
        findPiclp("xiulian.bmp",90,  16,1014,  87,1125)
        --斗气不足
        if findPic_boolean("douqibuzu.bmp",90, 219,526 , 252,601 )then
            clicktf(x,y)
            --关闭斗气界面
            clicklp( 616,1111)
        end
        --提示点击日常
        if findMuColor_boolean(color_richang,90, 464,626 , 525,732 ) then
            --点击日常
            clicklp( 514,994 )
        end
        --死亡矿洞
        if findMuColor_boolean(color_kuangdong,90, 425,223 , 466,381 ) then
            --点击死亡矿洞
            clicklp( 392,634 )
        end
        --提示开始挑战
        if findMuColor_boolean(color_tiaozhan,90, 131,468 , 189,612 ) then
            logD("主线提示开始挑战")
            notifyMessage("主线提示开始挑战")
            mSleep(2000)
            --点击开始挑战
            clicktf(  56,831 )
            mSleep(5000)
            --点击挂机
            findMuColorlp(color_guaji,90, 308,1040, 390,1131)
        end
        --关闭-------------------------------------------------------------------------------------------------------
        --点击纳戒
        findPiclp("najie.bmp",90, 192,20  , 286,127 )
        --幻境罗盘提示
        if findMuColor_boolean(color_luopan,90, 304,230 , 367,390 ) then
            --点击幻境罗盘副本
            clicklp( 257,630 )
        end
        --选择幻境罗盘难度
        if findMuColor_boolean(color_luopannandu,90, 174,725 , 238,877 ) then
            --点击选择难度
            clicklp( 114,439 )
        end
        --进入幻境罗盘副本
        if findMuColor_boolean(color_jinruhuanjing,90, 143,498 , 178,583 ) then
            logD("主线进入幻境罗盘副本")
            notifyMessage("主线进入幻境罗盘副本")
            mSleep(2000)
            clicklp(  56,845 )
            mSleep(5000)
            --点击挂机
            findMuColorlp(color_guaji,90, 308,1040, 390,1131)
        end
        --取消传承
        if findPic_boolean("chuanchengjiemian.bmp",90, 407,535 , 444,602 )then
            --取消传承
            findPiclp("quxiaochuancheng.bmp",90, 196,603 , 259,720 )
        end
        --提示点击风云争霸
        if findMuColor_boolean(color_fengyun,90, 341,328 , 378,421 ) then
            --点击进入风云争霸
            clicklp( 245,634 )
        end
        --提示查看风云信息
        if findMuColor_boolean(color_xinxi,90, 131,757 , 163,846 ) then
            --点击查看信息
            clicklp(  41,305 )
        end
        --提示挑战
        if findMuColor_boolean(color_fengyuntiaozhan,90, 259,815 , 321,914) then
            --点击擂台挑战
            clicklp( 193,568 )
        end
        --领取擂台奖励
        if findMuColor_boolean(color_leitaijiangli,90, 236,827 , 271,902 ) then
            --点击领取奖励
            clicklp( 230,1096)
        end
        --提示返回斗气大陆
        if findMuColor_boolean(color_fanhuidalu,90, 562,812 , 605,932 ) then
            --点击返回
            clicklp( 615,1110)
        end
        --提示进入悬赏任务
        if findMuColor_boolean(color_xuanshang,90, 396,188 , 433,321 ) then
            clicklp( 325,514 )
        end
        --提示为好友提升星级
        if findMuColor_boolean(color_tisheng,90, 396,343 , 437,433 ) then
            logD("主线好友提升星级")
            notifyMessage("主线好友提升星级")
            mSleep(2000)
            --点击
            clicktf( 317,880 )
            mSleep(3000)
            clicktf( 267,283 )
        end
        --出现变强界面退出循环 金币 异火
        if findPic_boolean("bianqiang.bmp",90, 262,193 , 318,248 )and
        findPic_boolean("bianqiang1.bmp",90, 123,200 , 174,247 )then
            --关闭变强界面
            clicklp( 583,935 )
            if counts == 1 or counts == 2 then
                local dengji = shibiedengji()
                notifyMessage(dengji.."级")
                logD(dengji.."级")
                mSleep(1500)
                if dengji<32 then
                    danrenluopan()
                    counts = 0
                end
            end
            --点击任务自动寻路
            findMuColortf(color_zhuxian,90, 342,74, 373,112 )
            counts = counts +1
            notifyMessage(counts.."找到变强")
            logD(counts)
            mSleep(1500)
        end
        --一键征友
        findPicLostColor("zhengyou.bmp",90, 299,846 , 334,940 ,0xFF00FF)
        --全部添加
        if findPic_boolean("quantianjia.bmp",90,  25,855 ,  66,968 )then
            --点击全部添加
            click(x,y)
            --关闭征友界面
            findPiclp("guanbizhengyou.bmp",90, 583,1074, 639,1133)
        end
        --点击悬赏任务
        --findPic("xuanshang.bmp",90, 298,471 , 401,584 )
        --点击接受悬赏任务
        --findPictf("xuanshangjieshou.bmp",90,  32,234 ,  91,363 )
        --提交任务
        findPicTime("tijiaorenwu.bmp",90,28,8, 126,323 )
        --接受任务
        findPicTime("jieshourenwu.bmp",90,  34,9   , 127,325 )
        --断网等操作
        exception()
        --提交任务
        findPicTime("tijiaorenwu.bmp",90,28,8, 126,323 )
        --接受任务
        findPicTime("jieshourenwu.bmp",90,  34,9   , 127,325 )
        if not findMuColor_boolean(color_douhunxiulian,90,   5,888 ,  91,1096)and
        not findPic_boolean("xiulian.bmp",90,  16,1014,  87,1125) and
        not findPicLostColor_boolean("likaifuben.bmp",90,  18,957 ,  70,1098,0xFF00FF)and
        not findPic_boolean("tupo.bmp",90,  10,1012,  85,1121) then
            --关闭全屏窗口
            findPiclp("guanbiditu.bmp",90, 571,1063, 638,1132)
            --关闭地图
            findPiclp("guanbiditu1.bmp",90,571,1063, 638,1132)
            --关闭药店
            findPictf("guanbiyaodian.bmp",90, 568,1058, 639,1134)
            --关闭日常
            findPictf("guanbirichang.bmp",90,571,1063, 638,1132)
            --后退
            findPictf("houtui.bmp",90, 583,1   , 639,58  )
        end
    end
end
--点开任务自动主线
function diankairenwu()
    --点开任务眼
    if not findMuColor_boolean(color_zhuxian,90, 342,74, 373,112 )then
        --logD("任务眼关闭状态下打开任务眼")
        --点击打开任务眼
        findMuColorlp(color_renwu,90, 288,0, 408,94)
    end
    --关闭NPC
    findPiclp("guanbiNPC.bmp",90, 575,277 , 639,334 )
    --下
    --立即装备
    findMuColorlp(color_liji,90, 214,252 , 244,354 )
    touchDown(0,  66,112 )
    mSleep(500)
    touchUp(0)
    --上
    mSleep(200)
    touchDown(0, 130,110 )
    mSleep(500)
    touchUp(0)
    --[[
    --点击挂机
    if findMuColor_boolean(color_guaji,90, 308,1040, 390,1131) then
        touchDown(0,x,y)
        mSleep(math.random(100,200))
        touchUp(0)
    end
    --]]
    --防止卡死点击技能
    findPictf("jineng.bmp",90,  40,893 , 108,976 )
    --点击任务自动寻路
    findMuColortf(color_zhuxian,90, 342,74, 373,112 )
    --使用获得的物品
    findMuColortf(color_huode,90, 269,115 , 305,243 )
    --立即装备
    findMuColortf(color_liji,90, 214,252 , 244,354 )
end
--点开任务自动侦查
function renwuzhencha()
    --点开任务眼
    if not findMuColor_boolean(color_zhuxian,90, 342,74, 373,112 )then
        --logD("任务眼关闭状态下打开任务眼")
        --点击打开任务眼
        findMuColor(color_renwu,90, 288,0, 408,94)
    end
    --关闭NPC
    findPictf("guanbiNPC.bmp",90, 575,277 , 639,334 )
    --使用获得的物品
    findMuColor(color_huode,90, 269,115 , 305,243 )
    --立即装备
    findMuColor(color_liji,90, 214,252 , 244,354 )
    --下
    touchDown(0,  66,112 )
    mSleep(500)
    touchUp(0)
    mSleep(500)
    --上
    mSleep(200)
    touchDown(0, 130,110 )
    mSleep(500)
    touchUp(0)
    mSleep(500)
    --[[
    --点击挂机
    if findMuColor_boolean(color_guaji,90, 308,1040, 390,1131) then
        touchDown(0,x,y)
        mSleep(math.random(100,200))
        touchUp(0)
    end
    --]]
    --防止卡死点击技能
    findPictf("jineng.bmp",90,  40,893 , 108,976 )
    --点击任务自动寻路侦查
    findMuColor(color_zhencha,90, 248,10  , 368,188 )
end
--创建账号
function create()
    mSleep(2000)
    --关闭游戏在开启游戏
    notifyMessage("账号重启游戏")
    mSleep(1500)
    logD("账号重启游戏")
    mSleep(1000)
    appKill("com.idreamsky.cqb.pp")
    mSleep(4000)
    appRun("com.idreamsky.cqb.pp")
    mSleep(5000)
    --第一点时间
    time1 = os.time()
    while true do
        --关闭配件
        findPictf("guanbipeijian.bmp",90, 227,509 , 291,628 )
        --运行游戏
        if not appRunning("com.idreamsky.cqb.pp") then
            --启动游戏
            appRun("com.idreamsky.cqb.pp")
        end
        --异常之类判断
        --exception()
        while true do 
            --超时重启   2分钟超时
            local time2 = os.time()
            if (time2 - time1)> 120 then
                time1 = os.time()
                notifyMessage("创建账号超时重启游戏")
                mSleep(1500)
                logD("创建账号超时重启游戏")
                --关闭游戏在开启游戏
                appKill("com.idreamsky.cqb.pp")
                mSleep(4000)
                appRun("com.idreamsky.cqb.pp")
                mSleep(5000)
            end
            --切换账号
            if findPic_boolean("qiehuanzhanghao.bmp",90, 290,658 , 348,782 )then
                click(x,y)
                break
            end
            --快速注册
            if findPic_boolean("kuaisuzhuce.bmp",90,  64,629 , 125,770 )then
                click(x,y)
                break
            end
            --账号注册
            if findPic_boolean("zhanghaozhuce.bmp",90,  73,500 , 127,716 )then
                click(x,y)
                break
            end
            --账号注册界面
            if findPic_boolean("zhanghao.bmp",90, 406,330 , 468,432 ) then
                break
            end
        end
        --判断当前是否有账号
        if dedaozhanghao() == nil then
            -----------开始创建账号--------------------------
            logD("注册账号")
            --快速注册
            findPictf("kuaisuzhuce.bmp",90,  64,629 , 125,770 )
            --账号注册
            findPictf("zhanghaozhuce.bmp",90,  73,500 , 127,716 )
            --账号注册界面
            if findPic_boolean("zhanghao.bmp",90, 406,330 , 468,432 ) then
                --点击账号
                --clickTime(x,y)
                --随机5-9位数字
                --shuzi =math.random(10000,999999999)
                --生成2位随机字母
                s = randomStr("abcdefghijklmnopqrstuvwxyz",9)
                --点击账号
                clickTime(x,y)
                mSleep(1000)
                --输入账号  6-16位,只能字母与数字,只能字母开头
                inputText("\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b")
                inputText(s)
                mSleep(1500)
                --关闭输入框
                click(35,1000)
                --点击密码
                findPic("mima.bmp",90, 313,324 , 387,423 )
                inputText("\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b")
                --输入密码   长度为6-20位
                inputText("a5531876")
                mSleep(1500)
                --点击done
                findPic("done_create.bmp",90,  10,921 ,  66,1050)
                --关闭输入框
                clicktf(35,1000)
                --点击确定进行账号的注册
                findPic("sure.bmp",90, 199,510 , 259,618 )
                mSleep(3000)
                --同意协议
                findPic("tongyixieyi.bmp",90,  66,774 , 108,866 )
                --[[
                --如果出现进入游戏界面说明注册成功
                if findPic_boolean("sure.bmp",90, 199,510 , 259,618 )then
                    --关闭游戏在开启
                    notifyMessage("注册失败重启游戏")
                    logD("注册失败重启游戏")
                    mSleep(2000)
                    --关闭游戏在开启游戏
                    appKill("com.idreamsky.cqb.pp")
                    mSleep(4000)
                    appRun("com.idreamsky.cqb.pp")
                    mSleep(5000)
                end
                --]]
                --进入游戏
                findPic("jinruyouxi.bmp",90,  61,619 , 151,699 )
                mSleep(5000)
                --进入游戏
                findPic("jinruyouxi.bmp",90,  61,619 , 151,699 )
                --选择元素师
                findPic("yuanshushi.bmp",90, 116,21  , 207,121 )
                if findPic_boolean("saizi.bmp",90,  31,622 ,  84,682 ) then
                    click(x,y)
                    --点击名字输入框
                    click(x,y-70)
                    --输入角色名字后缀名
                    inputText("裕仁")
                    mSleep(1500)
                    --点击return
                    findPic("return.bmp",90,  11,1022,  62,1085)
                    --裕仁结尾
                    if findMuColor_boolean(color_yuren,90,  40,469 ,  74,579 ) then

                        --确认创建
                        click(50,1000)
                        --findMuColor(color_juesejinru,90,   2,888 , 113,1130)
                        mSleep(3000)
                        --进入游戏后重启游戏
                        notifyMessage("角色创建成功,重启游戏")
                        logD("角色创建成功,重启游戏")
                        mSleep(2000)

                        --进行账号密码的写入
                        notifyMessage("账号密码写入文件")
                        logD("保存账号密码到文件")
                        mSleep(1500)
                        local file = assert(io.open("/var/touchelf/scripts/cqb_zh.txt", 'a'))
                        --只用写入账号就可以,不需写入密码
                        file:write(s.."\n")
                        file:close()
                        mSleep(5500)

                        --关闭游戏在开启游戏
                        appKill("com.idreamsky.cqb.pp")
                        mSleep(4000)
                        appRun("com.idreamsky.cqb.pp")
                        mSleep(5000)
                        --退出创建账号和角色的循环
                        return
                    end 
                end
            end   
        else
            ---------------------登陆界面----------------------------------------------------
            logD("登陆账号")
            --得到账号
            account = dedaozhanghao()
            --输入账号进入游戏
            --账号登陆界面
            if findPic_boolean("zhanghao.bmp",90, 406,330 , 468,432 ) then
                --点击账号
                clickTime(x,y)
                --输入账号  6-16位,只能字母与数字,只能字母开头
                inputText("\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b")
                inputText(account)
                mSleep(1500)
                --关闭输入框
                click(35,1000)
                --点击密码
                findPic("mima.bmp",90, 313,324 , 387,423 )
                inputText("\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b")
                --输入密码   长度为6-20位
                inputText("a5531876")
                mSleep(1500)
                --点击done
                findPic("done_create.bmp",90,  10,921 ,  66,1050)
                --关闭输入框
                click(35,1000)
                --立即登录
                findPic("lijidenglu.bmp",90, 221,492 , 287,646 )
                mSleep(2000)
                --同意协议
                findPic("tongyixieyi.bmp",90,  66,774 , 108,866 )
                --进入游戏
                findPic("jinruyouxi.bmp",90,  61,619 , 151,699 )
                --角色进入游戏
                if findMuColor_boolean(color_juesejinru,90,   2,888 , 113,1130) then
                    clicktf(x,y)
                    notifyMessage("角色进入游戏成功")
                    mSleep(1500)
                    logD("角色进入游戏成功")
                    return
                end
            end    
        end
    end
end
--随机字符串
function randomStr(str, num)
    local reStr ='';
    math.randomseed(tostring(os.time()):sub(5):reverse());
    for i = 1, num do
        local getStr = math.random(1, string.len(str));
        reStr = reStr .. string.sub(str, getStr, getStr);
    end
    return reStr;
end
--关闭弹窗
function guanbi()
    --关闭充值
    findPictf("guanbichongzhi.bmp",90, 579,918 , 632,978 )
    --取消使用金砖
    findPic("quxiaoJZ.bmp",90, 187,584 , 273,730 )
    --关闭招财
    findPic("guanbizhaocai.bmp",90, 551,1045, 638,1132)
    --全部领取
    findPic("quanbulingqu.bmp",90,  43,471 , 150,655 )
    --退出领奖界面
    findPic("tuichulingjiang.bmp",90, 550,950 , 631,1045)
    --退出签到
    findPic("guanbiqiandao.bmp",90, 557,841 , 612,904 )
    --关闭等级礼包界面
    findPic("guanbilibao.bmp",90, 542,906 , 596,963 )
    --关闭7日签到界面
    findPic("guanbi7ri.bmp",90, 584,904 , 633,958 )
    --关闭背包
    findPic("guanbiduanlu.bmp",90, 568,1051, 639,1131)
    --关闭纳戒界面
    findPic("guanbinajie.bmp",90, 579,1074, 639,1134)
    --关闭斗气界面
    findPictf("guanbidouqi.bmp",90, 578,1073, 639,1133)


    --退出签到
    findPictf("guanbiqiandao.bmp",90, 557,841 , 612,904 )
    --关闭队伍界面
    --findPictf("guanbiduiwu.bmp",90, 578,1067, 638,1134)
    --关闭界面
    --findPictf("guanbijiemian.bmp",90, 567,1065, 639,1133)
    --关闭窗口
    --findPictf("guanbick.bmp",90, 582,1074, 638,1133)
    --手机商城登陆取消
    findPictf("shangchengquxiao.bmp",90, 320,302 , 427,613 )
    --关闭副本难度选择
    --findPictf("guanbifb_1.bmp",90, 572,1068, 639,1133)
    --关闭界面
    --findPictf("guanbijiemian.bmp",90, 567,1065, 639,1133)
    --关闭bg窗口
    --findPictf("guanbibeibao.bmp",90, 573,1065, 639,1133)

    --关闭移动
    --findPictf("guanbiyidong.bmp",90, 432,703 , 491,761 )
    --关闭世界地图
    --findPictf("guanbishijie.bmp",90, 579,1076, 640,1134)
    --关闭副本1
    --findPictf("guanbifuben_1.bmp",90, 576,1070, 639,1134)
    --关闭NPC对话  天蛇府弟子
    findPictf("guanbiNPC_1.bmp",90, 575,268 , 638,328 )
    --离开副本
    if findPicLostColor_boolean("likaifuben.bmp",90,  18,957 ,  70,1098,0xFF00FF) then
        notifyMessage("离开副本")
        logD("离开副本")
        mSleep(8000)
        clicktf(x,y)
    end
    --关闭全屏窗口
    findPiclp("guanbiditu.bmp",90, 571,1063, 638,1132)
    --关闭地图
    findPiclp("guanbiditu1.bmp",90,571,1063, 638,1132)
    --关闭药店
    findPictf("guanbiyaodian.bmp",90, 568,1058, 639,1134)
    --关闭日常
    findPictf("guanbirichang.bmp",90,571,1063, 638,1132)
    --后退
    findPictf("houtui.bmp",90, 583,1   , 639,58  )
    --关闭设置
    --findPictf("guanbishezhi.bmp",90, 485,732 , 602,853 )
    --纳戒已完成
    findPictf("wancheng.bmp",90, 171,112 , 301,357 )
    --断线登陆界面进入游戏    
    if findPic_boolean("jinruyouxi.bmp",90,  16,382 , 171,738 )then
        --移动pp图标
        if findPicLostColor_boolean("pptubiao1.bmp",90, 481,63  , 567,159 ,0xFF00FF) then
            notifyMessage(x.."--"..y)
            logD("滑动屏幕")
            mSleep(1000)
            myMove_UD(x,y, 349,1105,10)
            mSleep(800)
            myMove_RL(520,1080, 434,1080,10)
            mSleep(1000)
        end
        findPic("jinruyouxi.bmp",90,  16,382 , 171,738 )
    end
    if findPic_boolean("jinruyouxi_2.bmp",90,16,382 , 171,738 )then
        --移动pp图标
        if findPicLostColor_boolean("pptubiao1.bmp",90, 481,63  , 567,159 ,0xFF00FF) then
            notifyMessage(x.."--"..y)
            logD("滑动屏幕")
            mSleep(1000)
            myMove_UD(x,y, 349,1105,10)
            mSleep(800)
            myMove_RL(520,1080, 434,1080,10)
            mSleep(1000)
        end
        findPic("jinruyouxi_2.bmp",90,16,382 , 171,738 )
    end
    --账号界面登陆
    findPictf("denglu.bmp",90, 147,470 , 268,658 )
    --登陆错误
    findPictf("denglucuowu.bmp",90, 191,436 , 287,733 )
    --角色进入
    findMuColortf(color_juesejinru,90,   2,888 , 113,1130)
    --活动公告
    findPictf("huodong.bmp",90,  51,489 , 120,638 )
    --关闭邮件界面
    findPictf("guanbiyoujian.bmp",90, 575,1068, 639,1134)
    --精彩内容
    findPictf("jingcaineirong.bmp",90, 561,919 , 618,973 )
    --关闭离线挂机界面
    findPictf("guanbiguaji.bmp",90, 427,755 , 492,834 )
    --sim卡提示
    findPictf("SIMhao.bmp",90, 208,385 , 313,821 )
    --横屏SIM卡提示
    findPic("SIMhao_hengp.bmp",90, 210,581 , 438,663 )
    --取消家族boss提示
    findPictf("jiazuboss.bmp",90, 193,595 , 267,727 )
    --取消家族boss进入提示
    findPictf("bossjinru.bmp",90, 194,595 , 271,726 )
    --关闭背包满提示
    findPictf("guanbitishi.bmp",90, 432,744 , 492,813 )
    --手机商城登陆取消
    findPictf("shangchengquxiao.bmp",90, 320,302 , 427,613 )
end

--找图忽略色
function findPicLostColor(path,per,x1,y1,x2,y2,color)
    x,y = findImageInRegionFuzzy(PIC_PATH..path,per,x1,y1,x2,y2,color)
    if x~=-1 and y~=-1 then
        click(x,y)
    end
end
--找图忽略色返回boolean
function findPicLostColor_boolean(path,per,x1,y1,x2,y2,color)
    x,y = findImageInRegionFuzzy(PIC_PATH..path,per,x1,y1,x2,y2,color)
    if x~=-1 and y~=-1 then
        return true
    else
        return false
    end
end
--多点找色  并点击
function findMuColor(table,per,x1,y1,x2,y2)
    x,y = findMultiColorInRegionFuzzy(table,per,x1,y1,x2,y2)
    click(x,y)
end
--多点找色  并点击
function findMuColortf(table,per,x1,y1,x2,y2)
    x,y = findMultiColorInRegionFuzzy(table,per,x1,y1,x2,y2)
    clicktf(x,y)
end
--多点找色  并点击
function findMuColorlp(table,per,x1,y1,x2,y2)
    x,y = findMultiColorInRegionFuzzy(table,per,x1,y1,x2,y2)
    clicklp(x,y)
end
--多点找色返回boolean值
function findMuColor_boolean(table,per,x1,y1,x2,y2)
    x,y = findMultiColorInRegionFuzzy(table,per,x1,y1,x2,y2)
    if x~=-1 and y~=-1 then
        return true
    else
        return false
    end
end
--找单色返回boolean值
function findOneColor_boolean(one,per,x1,y1,x2,y2)
    x,y = findColorInRegionFuzzy(one,per,x1,y1,x2,y2)
    if x~=-1 and y ~=-1 then
        return true
    else
        return false
    end
end
--寻找图片讨伐
function findPictf(path,per,x1,y1,x2,y2)
    x,y = findImageInRegionFuzzy(PIC_PATH..path,per,x1,y1,x2,y2)
    clicktf(x,y)
end
--寻找图片  并点击
function findPic(path,per,x1,y1,x2,y2)
    x,y = findImageInRegionFuzzy(PIC_PATH..path,per,x1,y1,x2,y2)
    click(x,y)
end
--寻找图片  并点击
function findPiclp(path,per,x1,y1,x2,y2)
    x,y = findImageInRegionFuzzy(PIC_PATH..path,per,x1,y1,x2,y2)
    clicklp(x,y)
end
--寻找图片  并点击
function findPicDialog(path,per,x1,y1,x2,y2)
    x,y = findImageInRegionFuzzy(PIC_PATH..path,per,x1,y1,x2,y2)
    clickDialog(x,y)
end
--寻找图片  并点击并重置时间
function findPicTime(path,per,x1,y1,x2,y2)
    x,y = findImageInRegionFuzzy(PIC_PATH..path,per,x1,y1,x2,y2)
    if x~=-1 and y~=-1 then
        time1 = os.time()
        clicklp(x,y)
    end
end
--找图返回boolean值
function findPic_boolean(path,per,x1,y1,x2,y2)
    x,y = findImageInRegionFuzzy(PIC_PATH..path,per,x1,y1,x2,y2)
    if x~=-1 and y~=-1 then
        return true
    else
        return false
    end
end
--点击事件短时间
function clicktf(x,y)
    if x~=-1 and y~=-1 then
        touchDown(0, x + math.random(-3, 3), y + math.random(-3, 3))
        mSleep(math.random(15,40))
        touchUp(0)
        mSleep(math.random(500,800))
    end
end
-- 点击函数封装
function clicklp(x, y)--随机小幅度点击
    if x~=-1 and y~=-1 then
        touchDown(0, x, y)
        mSleep(math.random(15,50))
        touchUp(0)
        mSleep(math.random(100,200))
    end
end



--点击事件短时间
function clickDialog(x,y)
    if x~=-1 and y~=-1 then
        touchDown(0, x, y)
        mSleep(math.random(15,40))
        touchUp(0)
        mSleep(math.random(200,400))
    end
end
--点击事件
function click(x,y)
    if x~=-1 and y~=-1 then
        touchDown(0,x,y)
        mSleep(math.random(100,200))
        touchUp(0)
        mSleep(3000)
    end
end
--重置时间的点击事件
function clickTime(x,y)
    if x~=-1 and y~=-1 then
        time1 = os.time()
        touchDown(0, x + math.random(-3, 3), y + math.random(-3, 3))
        mSleep(math.random(15,40))
        touchUp(0)
        mSleep(math.random(500,800))
    end
end
--上下滑动函数
function myMove_UD(x1, y1, x2, y2,speed)
    local step = speed
    if y2 > y1 then step = -speed end 
    local cnt = math.abs((y2 - y1) /speed)
    if cnt == 0 then
        cnt = 1
        step = math.abs(y2 - y1)
    end
    touchDown(0, x1, y1)
    mSleep(50)
    for i = 1, cnt do
        mSleep(50)
        y1 = y1 - step
        touchMove(0, x1, y1)
    end
    touchUp(0)
    mSleep(100)
end	
--左右滑动函数
--同myMove_UD
function myMove_RL(x1, y1, x2, y2,speed)
    local step = speed
    if x2 > x1 then step = -speed end 
    local cnt = math.abs((x2 - x1) / speed)
    if cnt == 0 then
        cnt = 1
        step = math.abs(x2 - x1)
    end
    touchDown(0, x1, y1)
    mSleep(50)
    for i = 1, cnt do
        mSleep(50)
        x1 = x1 - step
        touchMove(0, x1, y1)
    end
    touchUp(0)
    mSleep(100)
end
--滑动
function moveTo(x1,y1,x2,y2)
    logD("滑动屏幕")
    touchDown(0, x1, y1); 
    mSleep(100);            
    touchMove(0, x2, y2); 
    mSleep(100);        
    touchUp(0);             
end
--打印log日志
function logD(con)
    local time = os.time()
    local tt = os.date("*t", time)
    logDebug(tt.month.."月"..tt.day.."日  :  "..con.."10")
    mSleep(200)
end
--获取焦点
function qiantai()
    --电池
    x,y = findImageInRegionFuzzy(PIC_PATH.."dianchi.bmp",90, 540,2   , 636,39  )
    if x~=-1 and y~=-1 then
        logD("电池启动游戏")
        appRun("com.idreamsky.cqb.pp")
    end
end
--读取帐号
function dedaozhanghao()
    --  l=账号名             ourline账号所在行数
    local file,l,f,jiy,peny,ourline
    --读账号行数
    file = io.open("/var/touchelf/scripts/hanghao.txt","r")
    --账号行数
    ourline = tonumber(file:read())
    file:close()
    --读取账号名
    file = io.open("/var/touchelf/scripts/cqb_zh.txt","r")
    mSleep   (500)
    --行号标记
    f=0
    peny=1
    for l in file:lines() do
        f=f+1
        if ourline==f then
            zhaohao=l
            peny=2
            break
        end    
    end	
    mSleep   (500)
    file:close()
    if f>1 then
        jiy=1
    else
        jiy=1
    end 
    if tonumber(ourline)>=1 then
        local file,hello
        if tonumber(ourline)<=1 and peny==1 then
            --没有账号就返回nil
            return nil
        elseif tonumber(ourline) > 1 then 
            file = io.open("/var/touchelf/scripts/hanghao.txt","r")
            ourline = tonumber(file:read())
            file:close()
            file = io.open("/var/touchelf/scripts/hanghao.txt","w")
            file:write(1)
            file:close()
            file = io.open("/var/touchelf/scripts/hanghao.txt","r")
            ourline = tonumber(file:read())
            file:close()
--[[			while true do
				notifyMessage('练完了')mSleep(2000)
			end--]]
    end
    file = io.open("/var/touchelf/scripts/cqb_zh.txt","r")
    mSleep   (500)
    f=1
    for l in file:lines() do  
        if ourline==f then
            zhaohao=l
            break
        end 
        f=f+1
    end
    mSleep   (500)
    file:close()
end
zhaohao=string.match(zhaohao,"%s*(.-)%s*$")
return zhaohao
end
function jiesuo()
--锁屏开启
    if findPic_boolean("suoping.bmp",90,315,284,355,324)then
        logD("屏幕解锁")
        mSleep(1000)
        --点亮屏幕
        keyDown("HOME");    -- HOME键按下
        mSleep(100);        --延时100毫秒
        keyUp("HOME");
        mSleep(800)
        -- HOME键抬起
        --滑动解锁
        --myMove_UD(  63,978 , 598,983 ,5)
        moveTo(63,978 , 598,983)
        mSleep(3000)
    end
end
